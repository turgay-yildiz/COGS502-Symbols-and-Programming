<html><head><meta charset="UTF-8"></head><body><div style="white-space:pre;font-family:Monospace;color:#d8dee9;background-color:#303841;-moz-tab-size:4;tab-size:4;">			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------		METU Cognitive Sciences			-----------------------#"""<br>			"""#----------------------			Turgay Yıldız				-----------------------#"""<br>			"""#----------------------		yildiz.turgay@metu.edu.tr		-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.1 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Write LAMBDA expressions that<br><br>			returns the greatest of two integers.<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">></span> x y<span style="color:#5fb4b4;">)</span>  x   y <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>			given two integers, returns T if one or the other divides the other without<br>			remainder.<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x  y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">zerop</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">rem</span> x y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 			<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br>									<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">zerop</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">rem</span> y x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 			<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br>									<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 							<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			given a list of integers, returns the mean.<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">/</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reduce</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'+</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>			given a list of integers, returns the sum of their factorials – use your factorial<br>			solution.<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reduce</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#f97b58;">+</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> factorial lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">assume </span><span style="color:#a6acb9;">we </span><span style="color:#a6acb9;">have </span><span style="color:#a6acb9;">factorial</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.2 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure PAIR-PROD using MAPCAR and LAMBDA, which takes a list of two <br>			element lists of integers and returns a list of products of these pairs. E.g. an input<br>			like <br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">7</span> <span style="color:#f9ae58;">8</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">13</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> should yield <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">56</span> <span style="color:#f9ae58;">13</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span>.<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">pair-prod</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  lst<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">)</span><br><br>			"""#----------------------			Second Way				-----------------------#"""<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">pair-prod2</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reduce</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#f97b58;">*</span>  x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				  lst<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.3 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure that takes two lists as input and returns the list of their pairwise<br>			averages. Use only MAPCAR, LAMBDA and arithmetic operations in your definition.<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">func</span> <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">/</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> a b<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span>  x  y <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.4 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define your own REMOVE-IF.<br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#6699cc;font-style:italic;">oddp</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>									<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">my_remove_if</span> <span style="color:#5fb4b4;">(</span>func1 lst<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> lst<span style="color:#5fb4b4;">)</span><br>					<span style="color:#ec5f66;font-style:italic;">nil</span><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> func1 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">(</span>my_remove_if func1 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>my_remove_if func1 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>			"""#----------------------			Second Way				-----------------------#"""<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">my_remove_if2</span> <span style="color:#5fb4b4;">(</span>func1 lst result<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dolist</span> <span style="color:#5fb4b4;">(</span>i lst result<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> func1 i<span style="color:#5fb4b4;">)</span><br>							<span style="color:#ec5f66;font-style:italic;">nil</span> <br>							<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> i result<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.5 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define LENGTH using MAPCAR, LAMBDA, + and APPLY.<br><br>			'<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span> -> 5<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">my_length</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">apply</span> 	<span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#f97b58;">+</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br>												<span style="color:#f9ae58;">1</span><br>										<span style="color:#5fb4b4;">)</span><br>										lst<br>							<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>					<br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.6 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure that takes an integer n and gives a list of n random single digit<br>			numbers. Use the built-in RANDOM, MAKE-LIST, MAPCAR and LAMBDA in your solu-<br>			tion. Check the definition of the builtins you are not familiar with from reference<br>			books on the website or on the web.<br><br>			3   ->   '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">9</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">make_random_list</span> <span style="color:#5fb4b4;">(</span>n<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">random</span> <span style="color:#f9ae58;">10</span><span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">make-list</span> n<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.7 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure that takes two lists: a list N of numbers and a list P of symbols<br>			with function bindings, i.e. symbols used to define some single argument mathe-<br>			matical procedure with DEFUN. Your procedure should return a list with the same<br>			size as N, whose elements are lists consisting of values obtained by applying all<br>			the procedures in P to the corresponding element in N. For example, if you pro-<br>			vide your procedure with a list of symbols naming square, absolute value and<br>			float functions, <br><br>			e.g. <span style="color:#5fb4b4;">(</span>sqr <span style="color:#6699cc;font-style:italic;">abs</span> <span style="color:#6699cc;font-style:italic;">float</span><span style="color:#5fb4b4;">)</span>, and the list <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span>, <br><br>			it should return:<br>							<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1.0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">2</span> <span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2.0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">9</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">3.0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <br><br>			You are NOT allowed to use any procedure <span style="color:#5fb4b4;">(</span>built<span style="color:#f97b58;">-</span>in <span style="color:#f97b58;">or</span> user<span style="color:#f97b58;">-</span>defined<span style="color:#5fb4b4;">)</span> <br>			other than #', DEFUN, MAPCAR, LAMBDA and FUNCALL<br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>   <span style="color:#5fb4b4;">my_func</span> <span style="color:#5fb4b4;">(</span>lst1    lst2<span style="color:#5fb4b4;">)</span><br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span>  <span style="color:#5fb4b4;">(</span>y<span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> y x<span style="color:#5fb4b4;">)</span>    				<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">since </span><span style="color:#a6acb9;">y </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">be </span><span style="color:#a6acb9;">send </span><span style="color:#a6acb9;">like </span><span style="color:#a6acb9;">'y  </span><span style="color:#a6acb9;">otherwise </span><span style="color:#a6acb9;">unbound. </span><span style="color:#a6acb9;">no </span><span style="color:#a6acb9;">need </span><span style="color:#a6acb9;">for </span><span style="color:#a6acb9;">#'</span><br>																<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">mapcar </span><span style="color:#a6acb9;">sends </span><span style="color:#a6acb9;">values </span><span style="color:#a6acb9;">like </span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d)   </span><span style="color:#a6acb9;">->   </span><span style="color:#a6acb9;">'a </span><span style="color:#a6acb9;">'b </span><span style="color:#a6acb9;">'c </span><span style="color:#a6acb9;">'d</span><br>										<span style="color:#5fb4b4;">)</span><br>									lst2<span style="color:#5fb4b4;">)</span> <br>									<span style="color:#5fb4b4;">)</span><br>						    lst1<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span>my_func '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">sqrt</span> <span style="color:#6699cc;font-style:italic;">abs</span> <span style="color:#6699cc;font-style:italic;">float</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span>    output value is    <br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1.0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1.0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">C</span><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0.0</span> <span style="color:#f9ae58;">1.4142135</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">2</span> <span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2.0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1.7320508</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">3.0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.8 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure APPLIER that takes a procedure "proc", an input "input" and a<br>			count "cnt", and gives the result of applying proc to input cnt times. For instance,<br><br>			<span style="color:#5fb4b4;">(</span>APPLIER <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'CDR</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> should give <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">applier</span> <span style="color:#5fb4b4;">(</span>proc  input_ count_ <span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dotimes</span> <span style="color:#5fb4b4;">(</span>i count_ input_<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> input_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> proc input_<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>			"""#----------------------			Second Way				-----------------------#"""<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">applier2</span> <span style="color:#5fb4b4;">(</span>proc  input_ count_<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">last</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> input_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> proc input_<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>					<br>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">make-list</span> count_ :initial<span style="color:#f97b58;">-</span>element proc<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.9 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure MOST, which takes a list and a procedure argument, and returns<br>			the element in the list that gives the highest score when provided as an argument<br>			to the given procedure packed in a list with its score. To get full credit, solve the<br>			task WITHOUT using recursion or iteration, you can use MAPCAR, REDUCE<br>			and LAMBDA besides other built-ins you would need.<br><br>			* <span style="color:#5fb4b4;">(</span> most '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0.3</span> <span style="color:#f9ae58;">0.5</span> <span style="color:#f9ae58;">0.2</span><span style="color:#5fb4b4;">)</span> : proc # '<span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span> x <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> <span style="color:#f9ae58;">2</span> <span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">log</span> x <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0.5</span> <span style="color:#f97b58;">-</span><span style="color:#f9ae58;">1.3862944</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">most</span> <span style="color:#5fb4b4;">(</span>lst &amp;key <span style="color:#5fb4b4;">(</span>proc <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> <span style="color:#f9ae58;">2</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">log</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reduce</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">></span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cadr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cadr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>							x <br>							y<br>					<span style="color:#5fb4b4;">)</span>		<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>z<span style="color:#5fb4b4;">)</span><br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> z <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> proc z<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <br>						<span style="color:#5fb4b4;">)</span><br>					lst<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			* <span style="color:#5fb4b4;">(</span>most '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0.3</span> <span style="color:#f9ae58;">0.5</span> <span style="color:#f9ae58;">0.2</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0.5</span> <span style="color:#f97b58;">-</span><span style="color:#f9ae58;">1.3862944</span><span style="color:#5fb4b4;">)</span><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.10 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			The built-in FIND-IF returns the first element in its second argument that returns T<br>			for its first argument:<br><br>			* <span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">find-if</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span> x <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span> <span style="color:#f97b58;">></span> x <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 	'<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">9</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			9<br><br>			Define your own version of FIND-IF, which returns the index together with<br>			the element. Remember that indexing starts with 0. For instance your procedure<br>			should return <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span> for the above invocation, where 2 is the index of 9.<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">find-if-2</span> <span style="color:#5fb4b4;">(</span>proc lst<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>result 					<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>						  <span style="color:#5fb4b4;">(</span>len 						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						  <span style="color:#5fb4b4;">(</span>flag 					<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dotimes</span>  <span style="color:#5fb4b4;">(</span>i len result<span style="color:#5fb4b4;">)</span><br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> flag <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> proc <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">computation </span><span style="color:#a6acb9;">efficiency</span><br>								<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> i <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> flag <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>								<span style="color:#ec5f66;font-style:italic;">nil</span> <br>						<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			* <span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">find-if</span><span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span>  <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span> x <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span> <span style="color:#f97b58;">></span> x <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 	'<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">9</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span><br><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.11 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure REPLACE-IF, which takes three arguments: a list LST, an item<br>			ITEM and a function TEST, and replaces every element of LST that passes the TEST<br>			with ITEM. You may find using keyword arguments useful <span style="color:#5fb4b4;">(</span>see the lecture notes<span style="color:#5fb4b4;">)</span>.<br>			Make use of MAPCAR, LAMBDA and FUNCALL in your solution.<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">replace</span><span style="color:#f97b58;">-</span><span style="color:#c695c6;">if</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  '<span style="color:#f9ae58;">1</span>    '<span style="color:#6699cc;font-style:italic;">zerop</span><span style="color:#5fb4b4;">)</span>  <br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">REPLACE-IF</span> <span style="color:#5fb4b4;">(</span>lst arg test<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> test x<span style="color:#5fb4b4;">)</span><br>							arg<br>							x<br>					<span style="color:#5fb4b4;">)</span>		<br>							<span style="color:#5fb4b4;">)</span><br><br>				lst<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">replace</span><span style="color:#f97b58;">-</span><span style="color:#c695c6;">if</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  '<span style="color:#f9ae58;">1</span>    '<span style="color:#6699cc;font-style:italic;">zerop</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.12 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			MAPCAR can work on any number of lists<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">only </span><span style="color:#a6acb9;">need </span><span style="color:#a6acb9;">to </span><span style="color:#a6acb9;">be </span><span style="color:#a6acb9;">careful </span><span style="color:#a6acb9;">to </span><span style="color:#a6acb9;">provide </span><span style="color:#a6acb9;">a</span><br>			function with the correct number of arguments. For instance<br><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#c695c6;">mapcar</span> # '<span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span> x y <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> x y <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			gives <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">7</span> <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span>. Don’t worry if lists are not of equal length, MAPCAR goes as far as<br>			the shortest list.<br><br>			Define procedures that use MAPCAR and LAMBDA and<br><br>			• zip two lists together – <span style="color:#5fb4b4;">(</span>zip '<span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> should give <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>B <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>.<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">zip</span> <span style="color:#5fb4b4;">(</span>lst1 lst2<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> x y<span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">)</span><br>				lst1 lst2<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span>zip '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>B <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>C <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			• take three lists: first two will be lists of integers, and the third is a list of<br>			functions. Apply the corresponding function to corresponding arguments.<br><br>			<span style="color:#5fb4b4;">(</span>func12 '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span>   '<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f97b58;">*</span> <span style="color:#f97b58;">/</span> <span style="color:#f97b58;">-</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span>     -> 	 <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span>  <span style="color:#f9ae58;">4</span>  <span style="color:#f9ae58;">1</span>  <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span>	<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">func12</span> <span style="color:#5fb4b4;">(</span>lst1 lst2 lst3<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x y z<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">apply</span> z <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> x y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">)</span><br>				lst1 lst2 lst3<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span>func12 '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span>   '<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f97b58;">*</span> <span style="color:#f97b58;">/</span> <span style="color:#f97b58;">-</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br><br>											<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------		Differences Between Them 		-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br>			Funcall sees the elements one-by-one , even lists ! No loop !<br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> '<span style="color:#6699cc;font-style:italic;">list</span>  '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>					->			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				->	<span style="color:#5fb4b4;">(</span>A B C<span style="color:#5fb4b4;">)</span><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> '<span style="color:#6699cc;font-style:italic;">list</span>  '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span>  '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>			->			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>	->  <span style="color:#5fb4b4;">(</span>  <span style="color:#5fb4b4;">(</span>A B C<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> '<span style="color:#6699cc;font-style:italic;">car</span>  '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>						->			A<br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> '<span style="color:#6699cc;font-style:italic;">car</span>  '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>			->			ERROR !     Car takes one element.<br><br>			Apply sees all the elements in the LAST list at once : like parallel working<br>			If there is only one list. It sees everything in it together<br>			Apply is stingy/miser. It wants everything. But if the outputs is too much.<br>			It knows it can not eat all of that. It just wants the last aggregated data.<br>			Loop for the last element if list !  <br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">apply</span> '<span style="color:#6699cc;font-style:italic;">list</span>  '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>						->			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> 'a 'b 'c<span style="color:#5fb4b4;">)</span>				->		<span style="color:#5fb4b4;">(</span>A B C<span style="color:#5fb4b4;">)</span>	<br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">apply</span> '<span style="color:#6699cc;font-style:italic;">list</span>  '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span>  '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>			->			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> '<span style="color:#f9ae58;">1</span> '<span style="color:#f9ae58;">2</span> '<span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span>	->		<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A B C<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span>  <br><br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">apply</span> '<span style="color:#6699cc;font-style:italic;">car</span>  '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>						->			ERROR !     Car takes one element.<br><br>			Mapcar is different. It takes and gives back. It is very generous/bountiful<br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> '<span style="color:#6699cc;font-style:italic;">list</span>  '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>						->				<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>B<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>C<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> '<span style="color:#6699cc;font-style:italic;">list</span>  '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span>  '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>			->				<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>B <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>C <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> '<span style="color:#f97b58;">+</span>   <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#5fb4b4;">)</span>								->		6<br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">apply</span>   '<span style="color:#f97b58;">+</span>   <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span>					->		21   funcall would give error for this input.<br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  '<span style="color:#f97b58;">+</span>   '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span>						->		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  '<span style="color:#f97b58;">+</span>   '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#5fb4b4;">)</span>  '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">6</span> <span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span>			->		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">7</span> <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  '<span style="color:#f97b58;">+</span>   '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#5fb4b4;">)</span>  '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">6</span> <span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">9</span> <span style="color:#f9ae58;">19</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>		->		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">13</span> <span style="color:#f9ae58;">16</span> <span style="color:#f9ae58;">28</span><span style="color:#5fb4b4;">)</span><br><br>			mapcar takes only lists !<br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.13 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>							WHEN REAL MATHEMATICS COMES INTO THE GAME !<br><br>			The way to toss a fair coin in LISP is to do <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">random</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span>, which would evaluate to<br>			0 or 1 with a fifty-fifty chance.<br>			Study the following procedure and indicate what the parameters n, f, c and s<br>			stand for. In other words, describe what this procedure computes.<br><br>			<span style="color:#5fb4b4;">(</span>lets assume n<span style="color:#f97b58;">=</span><span style="color:#f9ae58;">3</span> <span style="color:#f97b58;">and</span> <span style="color:#6699cc;font-style:italic;">f</span><span style="color:#f97b58;">=</span><span style="color:#f9ae58;">1</span> , <span style="color:#f97b58;">and</span> n<span style="color:#f97b58;">=</span>number of heads <span style="color:#6699cc;font-style:italic;">f</span><span style="color:#f97b58;">=</span><span style="color:#f9ae58;">1</span> <span style="color:#c695c6;">for</span> head , <span style="color:#c695c6;">then</span> this function computes <br>			many <span style="color:#6699cc;font-style:italic;">random</span> coin tosses. <span style="color:#c695c6;">If</span> it reached the number of succeses <span style="color:#f97b58;">=</span> <span style="color:#f9ae58;">3</span> . <span style="color:#c695c6;">Then</span> it returns th<br>			number of trials<br>				<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">h</span> <span style="color:#5fb4b4;">(</span>n <span style="color:#6699cc;font-style:italic;">f</span> &amp;optional <span style="color:#5fb4b4;">(</span>c <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>s <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> c n <span style="color:#5fb4b4;">)</span><br>						s<br>						<span style="color:#5fb4b4;">(</span>h n <span style="color:#6699cc;font-style:italic;">f</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> c <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">random</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#6699cc;font-style:italic;">f</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> s <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">func</span> <span style="color:#5fb4b4;">(</span>number_success head_or_tail &amp;optional <span style="color:#5fb4b4;">(</span>counter <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>number_trials <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> counter number_success<span style="color:#5fb4b4;">)</span><br>						number_trials<br>						<span style="color:#5fb4b4;">(</span>func number_success head_or_tail <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">random</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> head_or_tail<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> number_trials <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>			Lets try to get 10 Heads in x tosses !<br><br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			19				<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">found </span><span style="color:#a6acb9;">in </span><span style="color:#a6acb9;">19 </span><span style="color:#a6acb9;">tosses. </span><br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			28<br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			17<br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			19<br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			17<br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			16<br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			19<br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			22<br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			18<br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			19<br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			22<br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			23<br>			* <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span><br>			17<br><br>			Lets prove the function !  <br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">prove</span> <span style="color:#5fb4b4;">(</span>n counter storage<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> counter n<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">float</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">/</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">apply</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'+</span>  storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span>prove n <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span>func <span style="color:#f9ae58;">10</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span>prove <span style="color:#f9ae58;">100</span> <span style="color:#f9ae58;">0</span> <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#5fb4b4;">)</span><br>			20.83<br><br>			* <span style="color:#5fb4b4;">(</span>prove <span style="color:#f9ae58;">1000</span> <span style="color:#f9ae58;">0</span> <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#5fb4b4;">)</span><br>			20.156<br><br>			* <span style="color:#5fb4b4;">(</span>prove <span style="color:#f9ae58;">10000</span> <span style="color:#f9ae58;">0</span> <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#5fb4b4;">)</span><br>			19.9234<br><br>			We proved that to get 10 Heads we need to toss the coin nearly 20 times. <br>			Because the probability is 0.5 .<br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.14 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Find the numbers in a given range that have the same Collatz length using the<br>			techniques of this section.<br><br>			<span style="color:#5fb4b4;">(</span>range <span style="color:#f97b58;">=</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">[</span><span style="color:#99c794;">1 </span><span style="color:#99c794;">6)</span><span style="color:#5fb4b4;">"</span>    <span style="color:#f97b58;">-</span><span style="color:#f97b58;">></span> assume <span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">99</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">8</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">6</span> <span style="color:#f9ae58;">99</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>    <span style="color:#f97b58;">-</span><span style="color:#f97b58;">></span>   <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f97b58;">and</span> <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">6</span> <span style="color:#f97b58;">and</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">collatz_generate</span> <span style="color:#5fb4b4;">(</span> n <span style="color:#5fb4b4;">)</span><br>					<br>					<span style="color:#5fb4b4;">(</span> <span style="color:#c695c6;">if</span> 	 <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> n <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>							'<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">cons</span> n <span style="color:#5fb4b4;">(</span> collatz_generate <span style="color:#5fb4b4;">(</span> <span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">evenp</span> n <span style="color:#5fb4b4;">)</span><br>																<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">/</span> n <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span><br>																<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> n <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			* <span style="color:#5fb4b4;">(</span>collatz_generate <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span>			->		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">16</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">collatz_length</span> <span style="color:#5fb4b4;">(</span> n <span style="color:#5fb4b4;">)</span><br>				<br>				<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> <span style="color:#5fb4b4;">(</span>collatz_generate n <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span>collatz_length <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span>				->		5<br><br><br>			I need a func like <span style="color:#5fb4b4;">(</span>range <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span>    ->   <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">range</span> <span style="color:#5fb4b4;">(</span>lower upper  storage<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> lower upper<span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span>range <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> lower <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> upper <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> lower storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">main</span> <span style="color:#5fb4b4;">(</span>lower upper counter<span style="color:#5fb4b4;">)</span><br><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> counter <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> upper lower<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#ec5f66;font-style:italic;">nil</span> <br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span><span style="color:#f97b58;">*</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>rnge 					<span style="color:#5fb4b4;">(</span>range lower upper <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>							  	  <span style="color:#5fb4b4;">(</span>result  					<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>						  		  <span style="color:#5fb4b4;">(</span>nt 						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> counter rnge<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						 		<span style="color:#5fb4b4;">)</span><br><br>							<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  <br><br>								<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dolist</span> <span style="color:#5fb4b4;">(</span>i rnge result<span style="color:#5fb4b4;">)</span><br>									<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#5fb4b4;">(</span>collatz_length i<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>collatz_length nt<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <br>											<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> i result<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>											<span style="color:#ec5f66;font-style:italic;">nil</span> <br>									<span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">(</span>main lower upper <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>								<br>							<span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			* <span style="color:#5fb4b4;">(</span>main <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">20</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">7</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">8</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">10</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">11</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">13</span> <span style="color:#f9ae58;">12</span><span style="color:#5fb4b4;">)</span> <br>			<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">13</span> <span style="color:#f9ae58;">12</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">15</span> <span style="color:#f9ae58;">14</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">15</span> <span style="color:#f9ae58;">14</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">16</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">17</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">18</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">18</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">temp</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">t</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">main2</span> <span style="color:#5fb4b4;">(</span>lower upper<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> temp <span style="color:#5fb4b4;">(</span>main lower upper <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 7.15 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">sort</span> '<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'&lt;</span> :key <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'cadr</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">sort</span>   input     func_for_comparison       func_for_transform_input<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">collatz_generate</span> <span style="color:#5fb4b4;">(</span> n <span style="color:#5fb4b4;">)</span><br>					<br>					<span style="color:#5fb4b4;">(</span> <span style="color:#c695c6;">if</span> 	 <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> n <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>							'<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">cons</span> n <span style="color:#5fb4b4;">(</span> collatz_generate <span style="color:#5fb4b4;">(</span> <span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">evenp</span> n <span style="color:#5fb4b4;">)</span><br>																<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">/</span> n <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span><br>																<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> n <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">collatz_length</span> <span style="color:#5fb4b4;">(</span> n <span style="color:#5fb4b4;">)</span><br>				<br>				<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> <span style="color:#5fb4b4;">(</span>collatz_generate n <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">sorted</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">sort</span> lst <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'></span> :key <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'collatz_length</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			* <span style="color:#5fb4b4;">(</span>sorted '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">6</span> <span style="color:#f9ae58;">7</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">9</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">9</span> <span style="color:#f9ae58;">7</span> <span style="color:#f9ae58;">6</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------					END 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""</div><script>window.print()</script></body></html>