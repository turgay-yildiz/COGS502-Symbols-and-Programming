<html><head><meta charset="UTF-8"></head><body><div style="white-space:pre;font-family:Monospace;color:#d8dee9;background-color:#303841;-moz-tab-size:4;tab-size:4;">			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------		METU Cognitive Sciences			-----------------------#"""<br>			"""#----------------------			Turgay Yıldız				-----------------------#"""<br>			"""#----------------------		yildiz.turgay@metu.edu.tr		-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 6.1 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure VALS that takes a list of one argument procedures and an argu-<br>			ment, and returns the values obtained by applying the procedures to the argument<br>			in the given order.<br><br>			<span style="color:#5fb4b4;">(</span>vals '<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">evenp</span> <span style="color:#6699cc;font-style:italic;">log</span> <span style="color:#6699cc;font-style:italic;">zerop</span><span style="color:#5fb4b4;">)</span>  <span style="color:#f9ae58;">8</span><span style="color:#5fb4b4;">)</span>    	will return  	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">T</span>    <span style="color:#f9ae58;">2.0794415</span>   <span style="color:#ec5f66;font-style:italic;">NIL</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>	<span style="color:#5fb4b4;">vals</span>	<span style="color:#5fb4b4;">(</span>list1    arg<span style="color:#5fb4b4;">)</span><br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> list1<span style="color:#5fb4b4;">)</span><br>								<span style="color:#ec5f66;font-style:italic;">nil</span> <br>								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> list1<span style="color:#5fb4b4;">)</span>   arg<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span>vals  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> list1<span style="color:#5fb4b4;">)</span>  arg<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""#----------------------			Second Way 				-----------------------#"""<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>	<span style="color:#5fb4b4;">vals</span>	<span style="color:#5fb4b4;">(</span>list1    arg   storage<span style="color:#5fb4b4;">)</span><br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> list1<span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span> <br>								<span style="color:#5fb4b4;">(</span>vals  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> list1<span style="color:#5fb4b4;">)</span>  arg   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> list1<span style="color:#5fb4b4;">)</span> arg<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 6.2 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure PAIRVALS that takes a list of one argument procedures and an<br>			argument, and returns the list of dotted pairs where each procedure is paired with<br>			the value obtained by applying it to the argument.<br><br>			<span style="color:#5fb4b4;">(</span>pairvals '<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">f</span> g h<span style="color:#5fb4b4;">)</span>  <span style="color:#f9ae58;">8</span><span style="color:#5fb4b4;">)</span>    should give   <span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">F</span>. <span style="color:#f9ae58;">64</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span>G. <span style="color:#f9ae58;">512</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span>H. <span style="color:#f9ae58;">2.079234</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>	<span style="color:#5fb4b4;">pairvals_</span>	<span style="color:#5fb4b4;">(</span>list1    args   func_list<span style="color:#5fb4b4;">)</span>      <br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> list1<span style="color:#5fb4b4;">)</span><br>							<span style="color:#ec5f66;font-style:italic;">nil</span><br>							<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> list1<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span>  func_list<span style="color:#5fb4b4;">)</span> args<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>		<br><br>										<span style="color:#5fb4b4;">(</span>pairvals_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> list1<span style="color:#5fb4b4;">)</span> args <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> func_list<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <br>					<span style="color:#5fb4b4;">)</span><br><br><br><br>			<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">func1</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> x x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">func2</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> x x x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>	<span style="color:#5fb4b4;">pairvals</span> 	<span style="color:#5fb4b4;">(</span>list1   args<span style="color:#5fb4b4;">)</span> <br><br>					<span style="color:#5fb4b4;">(</span>pairvals_  list1  args  '<span style="color:#5fb4b4;">(</span>func1 func2 <span style="color:#6699cc;font-style:italic;">log</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 6.3 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure MAXPAIR that takes a list of dotted pairs and returns the maxi-<br>			mum pair where the comparison is done on the basis of the second components of<br>			pairs.<br><br>			* <span style="color:#5fb4b4;">(</span>maxpair '<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A . <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>B . <span style="color:#f9ae58;">8</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>C . <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span>B . <span style="color:#f9ae58;">8</span><span style="color:#5fb4b4;">)</span><br><br>			Note that : <br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> '<span style="color:#5fb4b4;">(</span>a . <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>			0<br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> '<span style="color:#5fb4b4;">(</span>a <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> 	<span style="color:#5fb4b4;">maxpair</span>   <span style="color:#5fb4b4;">(</span>y  &amp;optional <span style="color:#5fb4b4;">(</span>storage '<span style="color:#5fb4b4;">(</span>a . <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span><br>						storage<br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">&lt;</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>							<span style="color:#5fb4b4;">(</span>maxpair   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>   storage<span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">(</span>maxpair   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""#----------------------			Second Way 				-----------------------#"""<br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">maxpair2</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reduce</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">></span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>							x<br>							y<br>					<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					lst<br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 6.4 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure that takes a list of predicate symbols <span style="color:#5fb4b4;">(</span>e.g. <span style="color:#6699cc;font-style:italic;">CONSP</span>, <span style="color:#6699cc;font-style:italic;">NUMBERP</span> etc.<span style="color:#5fb4b4;">)</span><br>			and an object, and returns the list of predicates that the object satisfies. Here is a<br>			sample interaction:<br><br>			<span style="color:#5fb4b4;">(</span>foo '<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">consp</span> <span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#6699cc;font-style:italic;">numberp</span><span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span>a<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> ==> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">CONSP</span> <span style="color:#6699cc;font-style:italic;">LISTP</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> 	<span style="color:#5fb4b4;">func</span> <span style="color:#5fb4b4;">(</span>list_pred  object   storage_success<span style="color:#5fb4b4;">)</span> 		<br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> list_pred<span style="color:#5fb4b4;">)</span> 								storage_success<span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> list_pred<span style="color:#5fb4b4;">)</span>  object<span style="color:#5fb4b4;">)</span> 			<span style="color:#5fb4b4;">(</span>func <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> list_pred<span style="color:#5fb4b4;">)</span> object <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> list_pred<span style="color:#5fb4b4;">)</span> storage_success<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 											<span style="color:#5fb4b4;">(</span>func <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> list_pred<span style="color:#5fb4b4;">)</span> object storage_success<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""#----------------------			Second Way 				-----------------------#"""<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">func4</span> <span style="color:#5fb4b4;">(</span>pred obj<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> x obj<span style="color:#5fb4b4;">)</span><br>							x<br>							<span style="color:#ec5f66;font-style:italic;">nil</span><br>					<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				pred<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 6.5 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure that takes a list of predicate symbols <span style="color:#5fb4b4;">(</span>e.g. <span style="color:#6699cc;font-style:italic;">CONSP</span>, <span style="color:#6699cc;font-style:italic;">NUMBERP</span> etc.<span style="color:#5fb4b4;">)</span><br>			and a list of objects, collects and returns all the objects that answer yes to at least<br>			one predicate in the predicate list.<br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">odd_p</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">integerp</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">oddp</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 					<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span> 	<br>						<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 											<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">even_p</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br>				<br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">integerp</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">evenp</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 					<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span> 	<br>						<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 											<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">func_</span> 	<span style="color:#5fb4b4;">(</span>list_pred  object<span style="color:#5fb4b4;">)</span> 								<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">func   </span><span style="color:#a6acb9;">'(odd_p </span><span style="color:#a6acb9;">even_p)    </span><span style="color:#a6acb9;">12  </span><span style="color:#a6acb9;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> list_pred<span style="color:#5fb4b4;">)</span> 									<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> list_pred<span style="color:#5fb4b4;">)</span>  object<span style="color:#5fb4b4;">)</span>					<span style="color:#ec5f66;font-style:italic;">t</span> <span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 												<span style="color:#5fb4b4;">(</span>func_  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> list_pred<span style="color:#5fb4b4;">)</span>  object<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> 	<span style="color:#5fb4b4;">func</span> 	<span style="color:#5fb4b4;">(</span>list_pred   list_object  storage_success<span style="color:#5fb4b4;">)</span>   <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">func   </span><span style="color:#a6acb9;">'(odd_p </span><span style="color:#a6acb9;">even_p)    </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">23  </span><span style="color:#a6acb9;">12.4  </span><span style="color:#a6acb9;">15.3 </span><span style="color:#a6acb9;">16 </span><span style="color:#a6acb9;">12.3)  </span><span style="color:#a6acb9;">nil)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> list_object<span style="color:#5fb4b4;">)</span> 							storage_success<span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>func_ list_pred <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> list_object<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 			<span style="color:#5fb4b4;">(</span>func  list_pred   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> list_object<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> list_object<span style="color:#5fb4b4;">)</span> storage_success<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 											<span style="color:#5fb4b4;">(</span>func  list_pred   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> list_object<span style="color:#5fb4b4;">)</span>   storage_success<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Any </span><span style="color:#a6acb9;">object </span><span style="color:#a6acb9;">that </span><span style="color:#a6acb9;">is </span><span style="color:#a6acb9;">not </span><span style="color:#a6acb9;">suitable </span><span style="color:#a6acb9;">for </span><span style="color:#a6acb9;">any </span><span style="color:#a6acb9;">function </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give </span><span style="color:#a6acb9;">error. </span><span style="color:#a6acb9;">E.g., </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">oddp  </span><span style="color:#a6acb9;">12.3)</span><br><br>			"""#----------------------			Second Way 				-----------------------#"""<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">func5</span> <span style="color:#5fb4b4;">(</span>list_pred   list_object result<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>obj<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dolist</span> <span style="color:#5fb4b4;">(</span>i list_pred result<span style="color:#5fb4b4;">)</span><br><br>							<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> i obj<span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result obj<span style="color:#5fb4b4;">)</span><br>								<span style="color:#ec5f66;font-style:italic;">nil</span><br>							<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					list_object<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			Note: <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> <span style="color:#c695c6;">with</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span><span style="color:#5fb4b4;">)</span> will not work . Because it will be detected as <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">''</span><span style="color:#5fb4b4;">)</span><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 6.6 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Define a procedure that takes a list of one argument numerical procedures <span style="color:#5fb4b4;">(</span>define<br>			your own <span style="color:#f97b58;">and</span><span style="color:#f97b58;">/</span><span style="color:#f97b58;">or</span> use the built<span style="color:#f97b58;">-</span>ins you know<span style="color:#5fb4b4;">)</span> and a number, and returns the name<br>			of the procedure that yields the maximum value when applied to the number argu-<br>			ment.<br><br><br>			 <span style="color:#5fb4b4;">(</span>square   cube   <span style="color:#6699cc;font-style:italic;">sqrt</span>   ... <span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">27</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">square</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> x x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">cube</span>   <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> x x x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">func</span>   <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> <span style="color:#f9ae58;">2</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> x x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  	<span style="color:#5fb4b4;">find_max</span>  <span style="color:#5fb4b4;">(</span>pred_list  x <span style="color:#5fb4b4;">)</span> 	<br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> pred_list<span style="color:#5fb4b4;">)</span><br>							<span style="color:#f9ae58;">0</span><br>							<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">max</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> pred_list<span style="color:#5fb4b4;">)</span>  x<span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span>find_max   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> pred_list<span style="color:#5fb4b4;">)</span>  x <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------			Exercise 6.7 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""<br><br>			Take a list and a procedure as input and return the list of indices of all the elements<br>			that the procedure returns a non-nil value.<br><br>			<span style="color:#5fb4b4;">(</span>func2  '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#6699cc;font-style:italic;">zerop</span>  <span style="color:#5fb4b4;">)</span>   ->   <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>   <span style="color:#5fb4b4;">func2</span>   <span style="color:#5fb4b4;">(</span>lst    pred  index  storage<span style="color:#5fb4b4;">)</span>        <br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> lst<span style="color:#5fb4b4;">)</span> 							<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">funcall</span> pred <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 				<span style="color:#5fb4b4;">(</span>func2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> pred <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> index <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> index storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 									<span style="color:#5fb4b4;">(</span>func2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> pred <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> index <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>             storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			"""#-----------------------------------------------------------------------------------#"""<br>			"""#----------------------					END 				-----------------------#"""<br>			"""#-----------------------------------------------------------------------------------#"""</div><script>window.print()</script></body></html>