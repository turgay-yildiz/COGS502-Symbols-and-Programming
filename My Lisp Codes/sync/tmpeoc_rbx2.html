<html><head><meta charset="UTF-8"></head><body><div style="white-space:pre;font-family:Monospace;color:#d8dee9;background-color:#303841;-moz-tab-size:4;tab-size:4;">"""#--------------------------------------------------------------------------------------#"""<br>"""#----------------------         METU Cognitive Sciences         -----------------------#"""<br>"""#----------------------          Symbols &amp; Programming          -----------------------#"""<br>"""#----------------------              Turgay Yıldız              -----------------------#"""<br>"""#----------------------        yildiz.turgay@metu.edu.tr        -----------------------#"""<br>"""#--------------------------------------------------------------------------------------#"""<br><br><br>"""#-----------------------------------------------------------------------------------#"""<br>"""#----------------------			Exercise 4.1				-----------------------#"""<br>"""#-----------------------------------------------------------------------------------#"""<br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Construct </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">lists </span><span style="color:#a6acb9;">formed </span><span style="color:#a6acb9;">by </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">below </span><span style="color:#a6acb9;">expressions, </span><span style="color:#a6acb9;">using </span><span style="color:#a6acb9;">only </span><span style="color:#a6acb9;">CONS, </span><span style="color:#a6acb9;">elements,</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">NIL </span><span style="color:#a6acb9;">– </span><span style="color:#a6acb9;">do </span><span style="color:#a6acb9;">not </span><span style="color:#a6acb9;">forget </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">quotes </span><span style="color:#a6acb9;">where </span><span style="color:#a6acb9;">needed.</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">a)(list </span><span style="color:#a6acb9;">'a </span><span style="color:#a6acb9;">'b </span><span style="color:#a6acb9;">'c)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'a <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'b <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'c <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">b)(list </span><span style="color:#a6acb9;">'a </span><span style="color:#a6acb9;">'b </span><span style="color:#a6acb9;">NIL)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'a <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'b <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------                   Exercise 4.2                   -------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Write </span><span style="color:#a6acb9;">forms </span><span style="color:#a6acb9;">consisting </span><span style="color:#a6acb9;">only </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">CONS, </span><span style="color:#a6acb9;">NIL, </span><span style="color:#a6acb9;">', </span><span style="color:#a6acb9;">A, </span><span style="color:#a6acb9;">B, </span><span style="color:#a6acb9;">C, </span><span style="color:#a6acb9;">D, </span><span style="color:#a6acb9;">which </span><span style="color:#a6acb9;">evaluate </span><span style="color:#a6acb9;">to </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">lists </span><span style="color:#a6acb9;">below.</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">  </span><span style="color:#a6acb9;">a-)   </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">D)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'A   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  'B <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   'C   <span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">cons</span>  '<span style="color:#c695c6;">D</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">( </span><span style="color:#a6acb9;">A  </span><span style="color:#a6acb9;">B  </span><span style="color:#a6acb9;">C  </span><span style="color:#a6acb9;">D)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">if </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">forget </span><span style="color:#a6acb9;">to </span><span style="color:#a6acb9;">use </span><span style="color:#a6acb9;">'   </span><span style="color:#a6acb9;">then </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give </span><span style="color:#a6acb9;">error </span><span style="color:#a6acb9;">"unbound </span><span style="color:#a6acb9;">variable" </span><span style="color:#a6acb9;">since </span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">does </span><span style="color:#a6acb9;">not </span><span style="color:#a6acb9;">know </span><span style="color:#a6acb9;">these </span><span style="color:#a6acb9;">symbols</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  'a  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>   <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">this </span><span style="color:#a6acb9;">is     </span><span style="color:#a6acb9;">((A))   </span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">because </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">does </span><span style="color:#a6acb9;">come </span><span style="color:#a6acb9;">from </span><span style="color:#a6acb9;">CAR </span><span style="color:#a6acb9;">not </span><span style="color:#a6acb9;">CDR.</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">like </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">cons </span><span style="color:#a6acb9;">something </span><span style="color:#a6acb9;">nil)  </span><span style="color:#a6acb9;">->  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">something)  </span><span style="color:#a6acb9;">->  </span><span style="color:#a6acb9;">((a))</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>    <span style="color:#ec5f66;font-style:italic;">nil</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  'a  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return    </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">NIL </span><span style="color:#a6acb9;">A)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   '<span style="color:#5fb4b4;">(</span>c <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span>    <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">((C </span><span style="color:#a6acb9;">D))      </span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  'a    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   '<span style="color:#5fb4b4;">(</span>c <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span>    <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">D)) </span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">  </span><span style="color:#a6acb9;">b-)  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A            </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B       </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">D)   </span><span style="color:#a6acb9;">)              </span><span style="color:#a6acb9;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'A                   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>      <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'B       <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#5fb4b4;">(</span>c <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>        <span style="color:#5fb4b4;">)</span>   <span style="color:#ec5f66;font-style:italic;">nil</span>   <span style="color:#5fb4b4;">)</span>                   <span style="color:#5fb4b4;">)</span> <br><br><span style="color:#a6acb9;">;</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">c-)  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A    </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">C) </span><span style="color:#a6acb9;">D </span><span style="color:#a6acb9;">) </span><span style="color:#a6acb9;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'A        <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   'B    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   '<span style="color:#5fb4b4;">(</span>C<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#c695c6;">D</span>   <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">to </span><span style="color:#a6acb9;">avoid </span><span style="color:#a6acb9;">dot </span><span style="color:#a6acb9;">"."   </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">have </span><span style="color:#a6acb9;">to </span><span style="color:#a6acb9;">extent </span><span style="color:#a6acb9;">to </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">"nil"   </span><span style="color:#a6acb9;">or</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'A     '<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>B <span style="color:#5fb4b4;">(</span>C<span style="color:#5fb4b4;">)</span> <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>     <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">this </span><span style="color:#a6acb9;">seems </span><span style="color:#a6acb9;">to </span><span style="color:#a6acb9;">be </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">joke. </span><span style="color:#a6acb9;">Be </span><span style="color:#a6acb9;">serious </span><span style="color:#a6acb9;">!</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">C) </span><span style="color:#a6acb9;">D))</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">d-)</span><br>      <br><br><span style="color:#5fb4b4;">(</span>            <span style="color:#5fb4b4;">(</span>       <span style="color:#5fb4b4;">(</span>A      <span style="color:#5fb4b4;">(</span>B   <span style="color:#5fb4b4;">(</span>C<span style="color:#5fb4b4;">)</span>   <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">)</span>       <span style="color:#5fb4b4;">)</span>          <span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">assume </span><span style="color:#a6acb9;">'(C) </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">X </span><span style="color:#a6acb9;">, </span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">then </span><span style="color:#a6acb9;">we </span><span style="color:#a6acb9;">need  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">X </span><span style="color:#a6acb9;">D)</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">assume </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">X </span><span style="color:#a6acb9;">D) </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">Y </span><span style="color:#a6acb9;">, </span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">then </span><span style="color:#a6acb9;">we </span><span style="color:#a6acb9;">need  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">Y)</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">assume  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">Y) </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">Z </span><span style="color:#a6acb9;">,</span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">then </span><span style="color:#a6acb9;">we </span><span style="color:#a6acb9;">need  </span><span style="color:#a6acb9;">((Z))</span><br><br><br>set : <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'Z <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>  ==  <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>Z<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>set : <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'A <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'Y <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   ==  <span style="color:#5fb4b4;">(</span>A Y<span style="color:#5fb4b4;">)</span><br><br>set : <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'B <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'X <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#c695c6;">D</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  == Y <br><br>set : <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'C <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> == X<br><br><br>Substitute Z with <span style="color:#5fb4b4;">(</span>A Y<span style="color:#5fb4b4;">)</span><br><br>now we have  :  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>       <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'A <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'Y <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>      <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><br>Substitute Y with <span style="color:#5fb4b4;">(</span>B X <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span><br><br>now we have : <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'A <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>         <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'B <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'X <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#c695c6;">D</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>           <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><br>Now, Substitute X :<br><br>now we have : <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'A <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'B <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>        <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'C <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>        <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#c695c6;">D</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'A <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'B <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'C <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#c695c6;">D</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">output </span><span style="color:#a6acb9;">: </span><span style="color:#a6acb9;">(((A </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">C) </span><span style="color:#a6acb9;">D))))</span><br><br>* <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> '<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A <span style="color:#5fb4b4;">(</span>B <span style="color:#5fb4b4;">(</span>C<span style="color:#5fb4b4;">)</span> <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  '<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A <span style="color:#5fb4b4;">(</span>B <span style="color:#5fb4b4;">(</span>C<span style="color:#5fb4b4;">)</span> <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><br><br>T<br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">lot </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">work: </span><span style="color:#a6acb9;">but </span><span style="color:#a6acb9;">guarantee </span><span style="color:#a6acb9;">result. </span><span style="color:#a6acb9;">No </span><span style="color:#a6acb9;">pain, </span><span style="color:#a6acb9;">no </span><span style="color:#a6acb9;">gain </span><span style="color:#a6acb9;">!</span><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------                   Exercise 4.3                   -------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Give </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">sequences </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">car’s </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">cdr’s </span><span style="color:#a6acb9;">needed </span><span style="color:#a6acb9;">to </span><span style="color:#a6acb9;">get </span><span style="color:#a6acb9;">x </span><span style="color:#a6acb9;">in </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">following </span><span style="color:#a6acb9;">expressions; </span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">for </span><span style="color:#a6acb9;">convenience </span><span style="color:#a6acb9;">name </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">list </span><span style="color:#a6acb9;">under </span><span style="color:#a6acb9;">discussion </span><span style="color:#a6acb9;">as </span><span style="color:#a6acb9;">lst </span><span style="color:#a6acb9;">– </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">first </span><span style="color:#a6acb9;">one </span><span style="color:#a6acb9;">is </span><span style="color:#a6acb9;">answered </span><span style="color:#a6acb9;">to</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">clarify </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">question:</span><br><br><span style="color:#5fb4b4;">(</span>a x b <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span>						->				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span>a b x <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span>						->				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> '<span style="color:#5fb4b4;">(</span>a b x <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>			->			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">caddr</span> '<span style="color:#5fb4b4;">(</span>a b x <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span>a <span style="color:#5fb4b4;">(</span>b <span style="color:#5fb4b4;">(</span>x <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>					->				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> 							= 		<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>b sth<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> , <br>												<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 					= 		<span style="color:#5fb4b4;">(</span>b sth<span style="color:#5fb4b4;">)</span> , <br>												<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> = <span style="color:#5fb4b4;">(</span>sth<span style="color:#5fb4b4;">)</span> 		= 		<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>X Y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>												<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  		= 		<span style="color:#5fb4b4;">(</span>X Y<span style="color:#5fb4b4;">)</span><br>												<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 	= 		X <br>												<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> '<span style="color:#5fb4b4;">(</span>a <span style="color:#5fb4b4;">(</span>b <span style="color:#5fb4b4;">(</span>x <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span>a <span style="color:#5fb4b4;">(</span>b <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>					->				<span style="color:#5fb4b4;">(</span>a <span style="color:#5fb4b4;">(</span>b sth x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>		=		lst<br>												<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>b sth x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>		= 		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><br>												<span style="color:#5fb4b4;">(</span>b sth x<span style="color:#5fb4b4;">)</span>			=		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>												<span style="color:#5fb4b4;">(</span>sth x<span style="color:#5fb4b4;">)</span>				=		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>												<span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span>					=		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>												x  					=		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>																			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> '<span style="color:#5fb4b4;">(</span>a <span style="color:#5fb4b4;">(</span>b <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>    <span style="color:#5fb4b4;">(</span>a <span style="color:#5fb4b4;">(</span>b <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>		->				<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>sth<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				=		lst<br>												<span style="color:#5fb4b4;">(</span>sth<span style="color:#5fb4b4;">)</span>				=		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><br>												 sth				=		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>	<br>												<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>b <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>		=		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>												<span style="color:#5fb4b4;">(</span>b <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span>			= 		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>	<br>												<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span>				= 		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>	<br>												<span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span>					=		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>												x 					=		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>																			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> '<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>a <span style="color:#5fb4b4;">(</span>b <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>	<br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------                   Exercise 4.4                   -------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>Given the list <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A B<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>C <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>E <span style="color:#6699cc;font-style:italic;">F</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>1. Write what you would get from it by applying the following "in order",<br><br><br> <span style="color:#5fb4b4;">(</span>a<span style="color:#5fb4b4;">)</span>CAR					:  <span style="color:#5fb4b4;">(</span>A B<span style="color:#5fb4b4;">)</span>				CDR = <span style="color:#5fb4b4;">(</span>  <span style="color:#5fb4b4;">(</span>C <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>E <span style="color:#6699cc;font-style:italic;">F</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <br> <span style="color:#5fb4b4;">(</span>b<span style="color:#5fb4b4;">)</span>CDR CDR				:  <span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>E <span style="color:#6699cc;font-style:italic;">F</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br> <span style="color:#5fb4b4;">(</span>c<span style="color:#5fb4b4;">)</span>CAR CDR				:  <span style="color:#5fb4b4;">(</span>B<span style="color:#5fb4b4;">)</span><br> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span>CDR CAR				:  <span style="color:#5fb4b4;">(</span>C <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span><br> <span style="color:#5fb4b4;">(</span>e<span style="color:#5fb4b4;">)</span>CDR CDR CAR			:  <span style="color:#5fb4b4;">(</span>E <span style="color:#6699cc;font-style:italic;">F</span><span style="color:#5fb4b4;">)</span><br> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">f</span><span style="color:#5fb4b4;">)</span> CDR CAR CDR CDR	:   nil<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>    list1     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'a <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'b <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'c <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#c695c6;">d</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'e  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#6699cc;font-style:italic;">f</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br> <br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">((A </span><span style="color:#99c794;">B) </span><span style="color:#99c794;">(</span><span style="color:#99c794;">C </span><span style="color:#99c794;">D) </span><span style="color:#99c794;">(</span><span style="color:#99c794;">E </span><span style="color:#99c794;">F))</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> list1<span style="color:#5fb4b4;">)</span><br>		<br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> list1<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">My </span><span style="color:#99c794;">answer </span><span style="color:#99c794;">: </span><span style="color:#99c794;">(</span><span style="color:#99c794;">A </span><span style="color:#99c794;">B)</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span>   <br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> list1<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">My </span><span style="color:#99c794;">answer </span><span style="color:#99c794;">: </span><span style="color:#99c794;">((E </span><span style="color:#99c794;">F))</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> list1<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">My </span><span style="color:#99c794;">answer </span><span style="color:#99c794;">: </span><span style="color:#99c794;">(</span><span style="color:#99c794;">B)</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> list1<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">My </span><span style="color:#99c794;">answer </span><span style="color:#99c794;">: </span><span style="color:#99c794;">(</span><span style="color:#99c794;">C </span><span style="color:#99c794;">D)</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span>	<br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> list1<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">My </span><span style="color:#99c794;">answer </span><span style="color:#99c794;">: </span><span style="color:#99c794;">(</span><span style="color:#99c794;">E </span><span style="color:#99c794;">F)</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> list1<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">My </span><span style="color:#99c794;">answer </span><span style="color:#99c794;">: </span><span style="color:#99c794;">nil</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><br>Given the list <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A B<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>C <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>E <span style="color:#6699cc;font-style:italic;">F</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>2. Which sequences of CARs and CDRs would get you A, B and F?<br><br><br><span style="color:#5fb4b4;">(</span>X Y Z<span style="color:#5fb4b4;">)</span> <br><br>			car = X = <span style="color:#5fb4b4;">(</span>A B<span style="color:#5fb4b4;">)</span>												cdr = <span style="color:#5fb4b4;">(</span>Y Z<span style="color:#5fb4b4;">)</span><br><br>car = "A" 					cdr = <span style="color:#5fb4b4;">(</span>B<span style="color:#5fb4b4;">)</span> 						car = Y = <span style="color:#5fb4b4;">(</span>C <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span> 					cdr = <span style="color:#5fb4b4;">(</span>Z<span style="color:#5fb4b4;">)</span> <br><br>						car = "B"  		cdr = nil 									car = <span style="color:#5fb4b4;">(</span>E <span style="color:#6699cc;font-style:italic;">F</span><span style="color:#5fb4b4;">)</span> 			cdr = nil<br><br>																			car = E  		cdr = <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">F</span><span style="color:#5fb4b4;">)</span><br><br>																						car = "F" 	cdr = nil <br><br><br>follow paths to find the sequences of car and cdr :<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>    x     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'a <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'b <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'c <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#c695c6;">d</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'e  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#6699cc;font-style:italic;">f</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br> <br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>    x     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'a <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'b <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'c <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#c695c6;">d</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'e  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#6699cc;font-style:italic;">f</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br> <br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>    x     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'a <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'b <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'c <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#c695c6;">d</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> 'e  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#6699cc;font-style:italic;">f</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br> <br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>		<br><span style="color:#5fb4b4;">)</span><br><br><br>"""#-----------------------------------------------------------------------------------#"""<br>"""#----------------------			Exercise 4.5				-----------------------#"""<br>"""#-----------------------------------------------------------------------------------#"""<br><br>Write down what the following expressions evaluate to<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">work </span><span style="color:#a6acb9;">them </span><span style="color:#a6acb9;">out </span><span style="color:#a6acb9;">before </span><span style="color:#a6acb9;">try-</span><br>ing on the computer. Some expressions might cause an error<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">just </span><span style="color:#a6acb9;">mark </span><span style="color:#a6acb9;">them </span><span style="color:#a6acb9;">as </span><span style="color:#a6acb9;">an</span><br>error, no need to specify the error itself.<br><br><br> 1. 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span>				->		error			cons takes two elements<br><br> 2. 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#f9ae58;">2</span> <span style="color:#ec5f66;font-style:italic;">NIL</span><span style="color:#5fb4b4;">)</span>			->		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span><br><br>3. 		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#f9ae58;">3</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>			->		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span><br><br>4. 		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#f9ae58;">3</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>			->		error			GRE, searches for a procedure<br><br>5. 		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#ec5f66;font-style:italic;">NIL</span> <span style="color:#ec5f66;font-style:italic;">NIL</span><span style="color:#5fb4b4;">)</span>			->		<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><br>6. 		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">NIL</span><span style="color:#5fb4b4;">)</span> 		->		error			GRE<br><br>7. 		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">NIL</span><span style="color:#5fb4b4;">)</span>		->		<span style="color:#5fb4b4;">(</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br><br>8. 		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span>A B<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">NIL</span><span style="color:#5fb4b4;">)</span>		->		error			GRE<br><br>9. 		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span>'A 'B<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">NIL</span><span style="color:#5fb4b4;">)</span>		->		error			GRE<br><br>10. 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#5fb4b4;">(</span>A B<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">NIL</span><span style="color:#5fb4b4;">)</span>		->		<span style="color:#5fb4b4;">(</span>  <span style="color:#5fb4b4;">(</span>A B<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br><br><br>11. 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#5fb4b4;">(</span>A B<span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span>C <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>	->		<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>A B<span style="color:#5fb4b4;">)</span> C <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span><br><br>12. 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span>				->		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span>			puts outputs/returned elements into a list<br><br>13.	 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#f9ae58;">1</span> '<span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span>				->		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span><br><br>14. 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> '<span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span>				->		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span><br><br>15. 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> 'A B<span style="color:#5fb4b4;">)</span>				->		ERROR			B returns 	"unbound error"<br><br>16. 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> 'A <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span>				->		<span style="color:#5fb4b4;">(</span>A <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span><br><br>17. 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> 'A 'B<span style="color:#5fb4b4;">)</span>			->		<span style="color:#5fb4b4;">(</span>A B<span style="color:#5fb4b4;">)</span><br><br>18. 	<span style="color:#5fb4b4;">(</span>'<span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span>				->		ERROR			GRE , there is no function that starts with a quote, I guess, <br><br>19. 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f9ae58;">2</span> '<span style="color:#f9ae58;">17</span><span style="color:#5fb4b4;">)</span>				->		19				->	VERY IMPORTANT !!! <br><br>Because : * <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">numberp</span> '<span style="color:#f9ae58;">19</span><span style="color:#5fb4b4;">)</span> 		returns    T       <span style="color:#5fb4b4;">(</span>Best prime, ever, <span style="color:#f9ae58;">19</span><span style="color:#5fb4b4;">)</span><br><br>""" Because ' quote does not turn them into strings. """<br><br>20.	 <span style="color:#5fb4b4;">(</span>'<span style="color:#f97b58;">+</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span>					->		ERROR			GRE, no such function, <br><br>21.	 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#f9ae58;">3</span> 'times '<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> 'is <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span>		->	<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> TIMES <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> IS <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span><br><br>22.	 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#f9ae58;">3</span> 'times <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> 'is '<span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span>		->	<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> TIMES <span style="color:#f9ae58;">3</span> IS <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span><br><br><br><br>"""#-----------------------------------------------------------------------------------#"""<br>"""#----------------------			Exercise 4.6				-----------------------#"""<br>"""#-----------------------------------------------------------------------------------#"""<br><br>Write down what the following expressions evaluate to<br><br>work them out before trying on the computer : <span style="color:#5fb4b4;">(</span>Roger that<span style="color:#5fb4b4;">)</span><br><br> 1.	 <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> 	'<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <br>		'ok <br>		'<span style="color:#f97b58;">not</span><span style="color:#f97b58;">-</span>really<br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">since </span><span style="color:#a6acb9;">'(list </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2) </span><span style="color:#a6acb9;">is </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">list, </span><span style="color:#a6acb9;">do </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">first </span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">repl </span><span style="color:#a6acb9;">: </span><span style="color:#a6acb9;">OK</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">note </span><span style="color:#a6acb9;">that </span><span style="color:#a6acb9;">"(list </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2)" </span><span style="color:#a6acb9;">does </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">same</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <br>		'it<span style="color:#f97b58;">-</span>is<span style="color:#f97b58;">-</span><span style="color:#f97b58;">not</span><span style="color:#f97b58;">-</span>fun<span style="color:#f97b58;">-</span>hocam<br>		'<span style="color:#f97b58;">not</span><span style="color:#f97b58;">-</span>really<br><span style="color:#5fb4b4;">)</span><br><br><br> 2. <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			'vice <br>			'versa<br><span style="color:#5fb4b4;">)</span><br><br> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>  will give error... GRE !  <span style="color:#5fb4b4;">(</span>Graduate Record Examinations !<span style="color:#5fb4b4;">)</span>  <br> <br>  if no quote, can not pass the exam !<br><br> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> '<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>   will give  TRUE, because it is null <span style="color:#5fb4b4;">(</span>nothing inside<span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> '<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> =  <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> '<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>   will give NIL, it has an element : nil<br><br>Difference between <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span><span style="color:#5fb4b4;">)</span> and <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span><span style="color:#5fb4b4;">)</span> is <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span><span style="color:#5fb4b4;">)</span> gives error if it is not a list . However, <br><br>* <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> 'a <span style="color:#5fb4b4;">)</span><br><br>NIL<br><br><br>3. <br><br><span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">></span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">></span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><br><br> <span style="color:#5fb4b4;">(</span> this <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">(</span><span style="color:#99c794;">if </span><span style="color:#99c794;">(> </span><span style="color:#99c794;">2 </span><span style="color:#99c794;">4) </span><span style="color:#99c794;">(- </span><span style="color:#99c794;">2 </span><span style="color:#99c794;">4) </span><span style="color:#99c794;">(+ </span><span style="color:#99c794;">2 </span><span style="color:#99c794;">4))</span><span style="color:#5fb4b4;">"</span> will give <span style="color:#f9ae58;">6</span>. However, <span style="color:#f9ae58;">6</span> is <span style="color:#f97b58;">NOT</span> a  <span style="color:#6699cc;font-style:italic;">list</span> !!!<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">(</span>therefore, <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span>    <span style="color:#ec5f66;font-style:italic;">nil</span>   sth <span style="color:#5fb4b4;">)</span>  . <span style="color:#c695c6;">if</span>  <span style="color:#f97b58;">and</span>  found a <span style="color:#ec5f66;font-style:italic;">nil</span> , output is <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#5fb4b4;">)</span>.<br><br><br>4. <br><br><span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">or</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">></span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">></span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><br><br>Returns "6" . Because "or" just searches for a non-nil.<br><br><br>5.<br><br><span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">or</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">or</span> '<span style="color:#f97b58;">or</span><span style="color:#5fb4b4;">)</span> '<span style="color:#f97b58;">and</span><span style="color:#5fb4b4;">)</span> 	'<span style="color:#f97b58;">or</span><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">and</span><br><br><br>"""#-------------------------------------------------------------------------------------#"""<br><br>"""	This is from old version of pdf 	"""<br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">The </span><span style="color:#a6acb9;">Collatz </span><span style="color:#a6acb9;">sequence </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">see </span><span style="color:#a6acb9;">Exercise </span><span style="color:#a6acb9;">3.6) </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">positive </span><span style="color:#a6acb9;">integer </span><span style="color:#a6acb9;">is </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">sequence </span><span style="color:#a6acb9;">starting</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">with </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">number </span><span style="color:#a6acb9;">itself </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">ending </span><span style="color:#a6acb9;">with </span><span style="color:#a6acb9;">1, </span><span style="color:#a6acb9;">where </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">numbers </span><span style="color:#a6acb9;">in-between </span><span style="color:#a6acb9;">are </span><span style="color:#a6acb9;">the</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">results </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">Collatz </span><span style="color:#a6acb9;">steps. </span><span style="color:#a6acb9;">For </span><span style="color:#a6acb9;">instance </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">Collatz </span><span style="color:#a6acb9;">sequence </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">is </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">10 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">16 </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">1.</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Given </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">non-negative </span><span style="color:#a6acb9;">integer, </span><span style="color:#a6acb9;">compute </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">count </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">even </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">odd </span><span style="color:#a6acb9;">numbers </span><span style="color:#a6acb9;">in</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">its </span><span style="color:#a6acb9;">Collatz </span><span style="color:#a6acb9;">sequence. </span><span style="color:#a6acb9;">Return </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">result </span><span style="color:#a6acb9;">as </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">list </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">two </span><span style="color:#a6acb9;">numbers, </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">first </span><span style="color:#a6acb9;">is </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">even</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">count </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">second </span><span style="color:#a6acb9;">is </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">odd </span><span style="color:#a6acb9;">count. </span><span style="color:#a6acb9;">The </span><span style="color:#a6acb9;">solution </span><span style="color:#a6acb9;">for </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">be </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">3).</span><br><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">collatz</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br>		<br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>     	<span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">evenp</span> x<span style="color:#5fb4b4;">)</span>		<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">/</span> x <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">oddp</span>  x<span style="color:#5fb4b4;">)</span>		<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> <span style="color:#f9ae58;">3</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">countEO</span> <span style="color:#5fb4b4;">(</span>x   &amp;key <span style="color:#5fb4b4;">(</span>even<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>odd<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> even<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> odd<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><br><br>		<br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">evenp</span> x<span style="color:#5fb4b4;">)</span>   <br>			<span style="color:#5fb4b4;">(</span>countEO  <span style="color:#5fb4b4;">(</span>collatz x<span style="color:#5fb4b4;">)</span>   :even<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> even<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>    :odd<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span>  odd<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>countEO  <span style="color:#5fb4b4;">(</span>collatz x<span style="color:#5fb4b4;">)</span>   :even<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> even<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span>          :odd<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> odd<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>			<br>"""#-----------------------------------------------------------------------------------#"""<br>"""#----------------------			Exercise 4.7				-----------------------#"""<br>"""#-----------------------------------------------------------------------------------#"""<br><br>Define a procedure named INSERT-2ND, which takes a list and an object, and gives<br>back a list where the element is inserted after the first element of the given list. As-<br>sume that the input list will have at least one element. Here is a sample interaction:<br><br><br><span style="color:#5fb4b4;">(</span> insert<span style="color:#f97b58;">-</span>2nd '<span style="color:#5fb4b4;">(</span> b k <span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span> a c <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				->			<span style="color:#5fb4b4;">(</span>A    <span style="color:#5fb4b4;">(</span> B K <span style="color:#5fb4b4;">)</span>    C <span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">insert-2nd</span>   <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span> <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>       x           <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span>   y  <span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">)</span>   <span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">insert-2nd</span>   <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span> <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span>   y <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">insert-2nd</span>   <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span> <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br>"""#-----------------------------------------------------------------------------------#"""<br>"""#----------------------			Exercise 4.8				-----------------------#"""<br>"""#-----------------------------------------------------------------------------------#"""<br><br>Define a procedure named REPLACE-2ND, which is like INSERT-2ND, but replaces<br>the element at the 2nd position. Assume that the input list will always have at least <br>two elements.<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">replace-2nd</span>   <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">replace</span><span style="color:#f97b58;">-</span>2nd   '<span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span>   '<span style="color:#5fb4b4;">(</span>a b c <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <br><br><span style="color:#5fb4b4;">(</span>A <span style="color:#5fb4b4;">(</span>X Y<span style="color:#5fb4b4;">)</span> C<span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">replace-2nd</span>   <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br><br>"""#-----------------------------------------------------------------------------------#"""<br>"""#----------------------			Exercise 4.9				-----------------------#"""<br>"""#-----------------------------------------------------------------------------------#"""<br><br>Define a procedure SWAP, that takes a two element list and switches the order of the<br>elements. You are allowed to use only CAR, CDR, CONS and NIL as built-ins.<br><br><span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span>   ->   <span style="color:#5fb4b4;">(</span>b a<span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">swap</span> <span style="color:#5fb4b4;">(</span>y<span style="color:#5fb4b4;">)</span>   <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br>"""#-----------------------------------------------------------------------------------#"""<br>"""#----------------------			Exercise 4.10				-----------------------#"""<br>"""#-----------------------------------------------------------------------------------#"""<br><br>Define a procedure that takes a list and an object, and returns a list where the object<br>is added to the end of the list.<br><br><br>'x   ,   '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span>     ->     '<span style="color:#5fb4b4;">(</span>a b c x<span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">append1</span>  <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  y    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> x  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">append1</span>  <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  y    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>"""#-----------------------------------------------------------------------------------#"""<br>"""#----------------------			Exercise 4.11				-----------------------#"""<br>"""#-----------------------------------------------------------------------------------#"""<br><br>Define your own procedure APPEND2 that appends two list arguments <span style="color:#5fb4b4;">(</span>I guess: two lists' arguments<span style="color:#5fb4b4;">)</span> <br>into a third list. You are not allowed to use APPEND, LIST and REVERSE – use just CONS.<br><br>'<span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span>c <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span>   ->    '<span style="color:#5fb4b4;">(</span>a b c <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span> <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">append2</span>   <span style="color:#5fb4b4;">(</span>x   y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>      <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br><br>"""#-----------------------------------------------------------------------------------#"""<br>"""#----------------------			Exercise 4.12				-----------------------#"""<br>"""#-----------------------------------------------------------------------------------#"""<br><br>Using CAR and CDR, define a procedure to return the fourth element of a list.<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">list-4th</span>  <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">cadddr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br><br>"""#-----------------------------------------------------------------------------------#"""<br>"""#----------------------			Exercise 4.13				-----------------------#"""<br>"""#-----------------------------------------------------------------------------------#"""<br><br>Define a procedure AFTER-FIRST that takes two lists and inserts all the elements in<br>the second list after the first element of the first list. <br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Given </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">D </span><span style="color:#a6acb9;">E) </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C), </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">should </span><span style="color:#a6acb9;">return </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A   </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C    </span><span style="color:#a6acb9;">D </span><span style="color:#a6acb9;">E).</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">after-first</span> <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  y <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.14					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a procedure AFTER-NTH that takes two lists and an index. It inserts all the<br>elements in the second list after the given index of the first list. Indices start with 0. <br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Given </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">D </span><span style="color:#a6acb9;">E), </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C), </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">1, </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">should </span><span style="color:#a6acb9;">return </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">D    </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C    </span><span style="color:#a6acb9;">E)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">get-last-n-elm</span> <span style="color:#5fb4b4;">(</span>x n<span style="color:#5fb4b4;">)</span>     <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">n  </span><span style="color:#a6acb9;">=  </span><span style="color:#a6acb9;">index  </span><span style="color:#a6acb9;">+  </span><span style="color:#a6acb9;">1</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span>  n   <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>		x<br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">get</span><span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">last</span><span style="color:#f97b58;">-</span>n<span style="color:#f97b58;">-</span>elm  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span>  n  <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">get-last-n-elm  </span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">f </span><span style="color:#a6acb9;">g </span><span style="color:#a6acb9;">h </span><span style="color:#a6acb9;">) </span><span style="color:#a6acb9;">5)  </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">f </span><span style="color:#a6acb9;">g </span><span style="color:#a6acb9;">h) </span><br><br>"""-----------------------------------------------------------------------------------"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">get-reverse-of-first-n-elm</span>  <span style="color:#5fb4b4;">(</span>x   n   storage<span style="color:#5fb4b4;">)</span>   <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">  </span><span style="color:#a6acb9;">n  </span><span style="color:#a6acb9;">=  </span><span style="color:#a6acb9;">index </span><span style="color:#a6acb9;">+ </span><span style="color:#a6acb9;">1</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span>  n  <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>			storage<br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">get</span><span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">reverse</span><span style="color:#f97b58;">-</span>of<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">first</span><span style="color:#f97b58;">-</span>n<span style="color:#f97b58;">-</span>elm  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span>  n  <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span>  x<span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">get-reverse-of-first-n-elm </span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">f </span><span style="color:#a6acb9;">g </span><span style="color:#a6acb9;">h </span><span style="color:#a6acb9;">)  </span><span style="color:#a6acb9;">5  </span><span style="color:#a6acb9;">nil)   </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give   </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">E </span><span style="color:#a6acb9;">D </span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">A)</span><span style="color:#a6acb9;">	</span><br><br>"""-----------------------------------------------------------------------------------"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">get-first-n-elm</span>   <span style="color:#5fb4b4;">(</span>x   n<span style="color:#5fb4b4;">)</span>                 <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">n   </span><span style="color:#a6acb9;">=   </span><span style="color:#a6acb9;">index </span><span style="color:#a6acb9;">+ </span><span style="color:#a6acb9;">1</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">get</span><span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">reverse</span><span style="color:#f97b58;">-</span>of<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">first</span><span style="color:#f97b58;">-</span>n<span style="color:#f97b58;">-</span>elm <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">get</span><span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">reverse</span><span style="color:#f97b58;">-</span>of<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">first</span><span style="color:#f97b58;">-</span>n<span style="color:#f97b58;">-</span>elm  x   n   <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> n <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">get-first-n-elm </span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">f </span><span style="color:#a6acb9;">g </span><span style="color:#a6acb9;">h </span><span style="color:#a6acb9;">)  </span><span style="color:#a6acb9;">5  </span><span style="color:#a6acb9;">nil)   </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give    </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">D </span><span style="color:#a6acb9;">E)  </span><br><br>"""-----------------------------------------------------------------------------------"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">insert-after-nth</span> <span style="color:#5fb4b4;">(</span>x y index<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  <span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">get</span><span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">first</span><span style="color:#f97b58;">-</span>n<span style="color:#f97b58;">-</span>elm x <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> index <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>      <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  y   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">get</span><span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">last</span><span style="color:#f97b58;">-</span>n<span style="color:#f97b58;">-</span>elm  x <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> index <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">insert-after-nth </span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">f </span><span style="color:#a6acb9;">g </span><span style="color:#a6acb9;">h) </span><span style="color:#a6acb9;">'(x) </span><span style="color:#a6acb9;">4)    </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give   </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">D </span><span style="color:#a6acb9;">E    </span><span style="color:#a6acb9;">X    </span><span style="color:#a6acb9;">F </span><span style="color:#a6acb9;">G </span><span style="color:#a6acb9;">H)</span><br><br><br>"""------------------					Second Way					-----------------"""<br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Given </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">D </span><span style="color:#a6acb9;">E), </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C), </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">1, </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">should </span><span style="color:#a6acb9;">return </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">D    </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C    </span><span style="color:#a6acb9;">E)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">helper_14</span> <span style="color:#5fb4b4;">(</span>lst index storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> index <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst <span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>helper_14 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> index <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><br>This will give <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>E<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">func14</span>  <span style="color:#5fb4b4;">(</span>lst1 lst2 index<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span>   <span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>divided 				<span style="color:#5fb4b4;">(</span>helper_14 lst1 index <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> divided<span style="color:#5fb4b4;">)</span> lst2  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> divided<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>* <span style="color:#5fb4b4;">(</span>func14 '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span> e <span style="color:#6699cc;font-style:italic;">f</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span>A B   <span style="color:#c695c6;">D</span> E <span style="color:#6699cc;font-style:italic;">F</span>    C<span style="color:#5fb4b4;">)</span><br><br><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.15					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Assume you have data that pairs employees’ last names with their monthly salaries.<br>E.g. <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>SMITH <span style="color:#f9ae58;">3000</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>JOHNS <span style="color:#f9ae58;">2700</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>CURRY <span style="color:#f9ae58;">4200</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> Define a procedure that takes<br>as input employee data and a threshold salary <span style="color:#5fb4b4;">(</span>an integer<span style="color:#5fb4b4;">)</span>, and returns in a list the<br>last names of all the employees that earn above the threshold salary. Define two<br>versions, one with, and one without an accumulator.<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">above-TH</span>  <span style="color:#5fb4b4;">(</span>x  th  storage<span style="color:#5fb4b4;">)</span>		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">( </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">100) </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">150) </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">200)) </span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span><br>		storage<br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">>=</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cadar</span> x<span style="color:#5fb4b4;">)</span>  th<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>above<span style="color:#f97b58;">-</span>TH   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  th   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">caar</span> x<span style="color:#5fb4b4;">)</span>   storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>above<span style="color:#f97b58;">-</span>TH   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  th     storage<span style="color:#5fb4b4;">)</span> <br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">above-TH2</span>  <span style="color:#5fb4b4;">(</span>x  th<span style="color:#5fb4b4;">)</span>		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">( </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">100) </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">150) </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">200))</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span><br>		<span style="color:#ec5f66;font-style:italic;">nil</span> <br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">>=</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cadar</span> x<span style="color:#5fb4b4;">)</span>  th<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">caar</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span>above<span style="color:#f97b58;">-</span>TH2   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  th<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>above<span style="color:#f97b58;">-</span>TH2   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  th<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.16					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Using MEMBER and LENGTH, write a function ORDER which gives the order of an item<br>in a list. You can do this by combining LENGTH and MEMBER in a certain way. It<br>should behave as follows:<br><br>* <span style="color:#5fb4b4;">(</span>order 'c '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>3<br>* <span style="color:#5fb4b4;">(</span>order 'z '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>NIL <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">order</span> <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span>				<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">member </span><span style="color:#a6acb9;">'x </span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c  </span><span style="color:#a6acb9;">x  </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">f))   </span><span style="color:#a6acb9;">-></span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">x </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">f </span><span style="color:#a6acb9;">)</span><br>	<br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">member</span> x  y<span style="color:#5fb4b4;">)</span>  <br>			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> y<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">member</span> x y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>    <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#ec5f66;font-style:italic;">nil</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.17					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a procedure that computes the sum of a list of numbers  with and without<br>an accumulator. Consider that there might be non-number elements in a list, which t<br>you should ignore in your summation.<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">add_list</span> <span style="color:#5fb4b4;">(</span>x   storage<span style="color:#5fb4b4;">)</span>    	<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">storage </span><span style="color:#a6acb9;">initially </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">0</span><br>									<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">x </span><span style="color:#a6acb9;">-> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">11 </span><span style="color:#a6acb9;">23 </span><span style="color:#a6acb9;">45 </span><span style="color:#a6acb9;">bg </span><span style="color:#a6acb9;">... </span><span style="color:#a6acb9;">)</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span>  x<span style="color:#5fb4b4;">)</span><br>		storage<br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">numberp</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>add_list  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span>  storage  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>add_list  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  	storage<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">add-list2</span>  <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span><br>			 <span style="color:#f9ae58;">0</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">numberp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>add<span style="color:#f97b58;">-</span>list2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span>add<span style="color:#f97b58;">-</span>list2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.18					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a procedure that returns the largest number in a list of numbers. Do not use<br>the built-in MAX.<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">find_max</span>  <span style="color:#5fb4b4;">(</span>x    max_value<span style="color:#5fb4b4;">)</span>   <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">initially </span><span style="color:#a6acb9;">zero     </span><span style="color:#a6acb9;">x </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">7)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span><br>		max_value<br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">numberp</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span>  x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">></span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  max_value<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>find_max   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>find_max   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   max_value<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""	-----------------		Second way		-----------------	"""<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">make_number</span> <span style="color:#5fb4b4;">(</span>x storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span><br>		storage<br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">numberp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>make_number   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>    storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>make_number   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   		  storage<span style="color:#5fb4b4;">)</span> <br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">find_max_2</span>  <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span>	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>	y	<span style="color:#5fb4b4;">(</span>make_number x <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>                      <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5)</span><br>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">></span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cadr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span>find_max_2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cddr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">I </span><span style="color:#a6acb9;">dont </span><span style="color:#a6acb9;">take </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">small </span><span style="color:#a6acb9;">value, </span><span style="color:#a6acb9;">get </span><span style="color:#a6acb9;">rid </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">them. </span><br>					<span style="color:#5fb4b4;">(</span>find_max_2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cadr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cddr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Perfect </span><span style="color:#a6acb9;">code </span><span style="color:#a6acb9;">! </span><span style="color:#a6acb9;">Neither </span><span style="color:#a6acb9;">accumulator </span><span style="color:#a6acb9;">nor </span><span style="color:#a6acb9;">nesting.</span><br>			<span style="color:#5fb4b4;">)</span>												 <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">In </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">end, </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">car </span><span style="color:#a6acb9;">y) </span><span style="color:#a6acb9;">is </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">biggest </span><span style="color:#a6acb9;">one </span><span style="color:#a6acb9;">!</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4."19"					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a procedure that takes a list of integers and returns the second largest integer<br>in the list.<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">sec_largest</span>  <span style="color:#5fb4b4;">(</span>x   sec_val   max_val<span style="color:#5fb4b4;">)</span>    <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">initially </span><span style="color:#a6acb9;">0 </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">1    </span><span style="color:#a6acb9;">("19" </span><span style="color:#a6acb9;">23 </span><span style="color:#a6acb9;">17)   </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">23 </span><span style="color:#a6acb9;">17 </span><span style="color:#a6acb9;">"19")  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">17 </span><span style="color:#a6acb9;">"19" </span><span style="color:#a6acb9;">23)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span><br>		sec_val<br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">></span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>    max_val<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>sec_largest   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   max_val    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">></span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>    sec_val<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span>sec_largest   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>    max_val<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span>sec_largest   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>    sec_val    max_val <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""	-----------------		Second way		-----------------	"""<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">sec_largest_2</span> <span style="color:#5fb4b4;">(</span>lst storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span> max_val 				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">apply</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#f97b58;">max</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">7 </span><span style="color:#a6acb9;">"19" </span><span style="color:#a6acb9;">23 </span><span style="color:#a6acb9;">11 </span><span style="color:#a6acb9;">7)</span><br>			 <span style="color:#5fb4b4;">(</span> car_ 				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			 <span style="color:#5fb4b4;">(</span> cdr_ 				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>										<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">********************************************</span><br>			<span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> car_  max_val<span style="color:#5fb4b4;">)</span> 			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">apply</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#f97b58;">max</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage  cdr_<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>    		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">get </span><span style="color:#a6acb9;">rid </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">max, </span><span style="color:#a6acb9;">then </span><span style="color:#a6acb9;">take </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">new </span><span style="color:#a6acb9;">max</span><br>			 	<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 								<span style="color:#5fb4b4;">(</span>sec_largest_2 cdr_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  car_ storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Great </span><span style="color:#a6acb9;">!</span><br>		<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.20					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a procedure that takes a list of integers and an integer n, and returns the nth<br>largest integer in the list.<br><br>'<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span>  4    ->   4<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">find-smallest</span>  <span style="color:#5fb4b4;">(</span>x    smallest<span style="color:#f97b58;">-</span>value   index   pseudo<span style="color:#f97b58;">-</span>index<span style="color:#5fb4b4;">)</span>      <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">initially </span><span style="color:#a6acb9;">smallest-value  </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">big </span><span style="color:#a6acb9;">number</span><br>																		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">index </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">pseudo-index </span><span style="color:#a6acb9;">are </span><span style="color:#a6acb9;">initially </span><span style="color:#a6acb9;">0.</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  smallest<span style="color:#f97b58;">-</span>value <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> index <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>		<br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">&lt;</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  smallest<span style="color:#f97b58;">-</span>value<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">find</span><span style="color:#f97b58;">-</span>smallest   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> pseudo<span style="color:#f97b58;">-</span>index <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> pseudo<span style="color:#f97b58;">-</span>index <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">find</span><span style="color:#f97b58;">-</span>smallest   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   smallest<span style="color:#f97b58;">-</span>value     index     <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> pseudo<span style="color:#f97b58;">-</span>index <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">output </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">be </span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">smallest-value    </span><span style="color:#a6acb9;">index) </span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">find-smallest </span><span style="color:#a6acb9;">'(4  </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">7 </span><span style="color:#a6acb9;">90 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">7 </span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">)  </span><span style="color:#a6acb9;">999999999999999  </span><span style="color:#a6acb9;">0 </span><span style="color:#a6acb9;">0 </span><span style="color:#a6acb9;">)            </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give</span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">5) </span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">ordered</span> <span style="color:#5fb4b4;">(</span>x  ordered<span style="color:#f97b58;">-</span>x<span style="color:#5fb4b4;">)</span>  <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">ordered-x  </span><span style="color:#a6acb9;">initially </span><span style="color:#a6acb9;">nil  </span><span style="color:#a6acb9;">()</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span><br>		ordered<span style="color:#f97b58;">-</span>x<br>		<br>		<span style="color:#5fb4b4;">(</span>ordered  	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">subseq</span>    x   <span style="color:#f9ae58;">0</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">find</span><span style="color:#f97b58;">-</span>smallest  x    <span style="color:#f9ae58;">999999999</span>   <span style="color:#f9ae58;">0</span>   <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">subseq</span>    x   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f9ae58;">1</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">find</span><span style="color:#f97b58;">-</span>smallest  x    <span style="color:#f9ae58;">999999999</span>   <span style="color:#f9ae58;">0</span>   <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">find</span><span style="color:#f97b58;">-</span>smallest  x    <span style="color:#f9ae58;">999999999</span>   <span style="color:#f9ae58;">0</span>   <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  ordered<span style="color:#f97b58;">-</span>x<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">ordered </span><span style="color:#a6acb9;">'(2 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">7 </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">0 </span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">6 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">) </span><span style="color:#a6acb9;">nil) </span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give</span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">7 </span><span style="color:#a6acb9;">6 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">0)</span><span style="color:#a6acb9;">	</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">ordered-2</span>   <span style="color:#5fb4b4;">(</span>x  ordered<span style="color:#f97b58;">-</span>x<span style="color:#5fb4b4;">)</span>  <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">ordered-x  </span><span style="color:#a6acb9;">initially </span><span style="color:#a6acb9;">nil  </span><span style="color:#a6acb9;">()</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> <span style="color:#5fb4b4;">(</span>	<span style="color:#5fb4b4;">(</span>smallest      <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">find</span><span style="color:#f97b58;">-</span>smallest  x    <span style="color:#f9ae58;">999999999</span>   <span style="color:#f9ae58;">0</span>   <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">(</span>index         <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">find</span><span style="color:#f97b58;">-</span>smallest  x    <span style="color:#f9ae58;">999999999</span>   <span style="color:#f9ae58;">0</span>   <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span><br>			ordered<span style="color:#f97b58;">-</span>x<br>		<br>			<span style="color:#5fb4b4;">(</span>ordered<span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span>  	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">subseq</span>    x   <span style="color:#f9ae58;">0</span>     index <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">subseq</span>    x   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f9ae58;">1</span>  index <span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> smallest  ordered<span style="color:#f97b58;">-</span>x<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">n-th-largest</span>  <span style="color:#5fb4b4;">(</span>x   n<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> n <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span> ordered x    <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  <br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">n-th-largest-2</span>  <span style="color:#5fb4b4;">(</span>x  n<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> n  <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">(</span>n<span style="color:#f97b58;">-</span>th<span style="color:#f97b58;">-</span>largest <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> n <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""	-----------------		Second way		-----------------	"""<br><br>'<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">4</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">3</span><span style="color:#5fb4b4;">"</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  	3    ->   3<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">order_</span>  <span style="color:#5fb4b4;">(</span>lst   storage<span style="color:#5fb4b4;">)</span>								<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">********************************************</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>					<br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span> max_val 			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">apply</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#f97b58;">max</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>			<br>			 		 <span style="color:#5fb4b4;">(</span> car_ 				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			 		 <span style="color:#5fb4b4;">(</span> cdr_ 				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<br>					<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> car_   max_val <span style="color:#5fb4b4;">)</span> 		<span style="color:#5fb4b4;">(</span>order_ cdr_  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> car_ storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">if </span><span style="color:#a6acb9;">found, </span><span style="color:#a6acb9;">change </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">place </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">it</span><br>					<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 							<span style="color:#5fb4b4;">(</span>order_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> cdr_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> car_<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>	<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">if </span><span style="color:#a6acb9;">not, </span><span style="color:#a6acb9;">send </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">to </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">back </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">line</span><br>				<span style="color:#5fb4b4;">)</span>																					<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">You </span><span style="color:#a6acb9;">are </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">best </span><span style="color:#a6acb9;">! </span><br>			<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">nth_largest_3</span>  <span style="color:#5fb4b4;">(</span>lst n<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> n <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>order_ lst <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.21					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a procedure that gives the last element of a list or gives NIL if the list is<br>empty. Name your procedure LASTT in order not to clash with LISP’s built-in LAST.<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">last1</span>  <span style="color:#5fb4b4;">(</span>x    last_element<span style="color:#5fb4b4;">)</span>     <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">x </span><span style="color:#a6acb9;">19)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span><br>		last_element<br>		<span style="color:#5fb4b4;">(</span>last1  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""	-----------------		Second way		-----------------	"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">last2</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">last3</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">We </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">force </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">man </span><span style="color:#a6acb9;">! </span><span style="color:#a6acb9;">Consider </span><span style="color:#a6acb9;">every </span><span style="color:#a6acb9;">possibility. </span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">last4</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">(</span>last4 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.22					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a procedure MULTI-MEMBER that checks if its first argument occurs more<br>than once in the second.<br><br>'x  '<span style="color:#5fb4b4;">(</span>a b <span style="color:#5fb4b4;">(</span>c x<span style="color:#5fb4b4;">)</span> x <span style="color:#c695c6;">d</span> e<span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">multi-member</span>  <span style="color:#5fb4b4;">(</span>x   y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> y<span style="color:#5fb4b4;">)</span><br>		 <span style="color:#ec5f66;font-style:italic;">nil</span><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>multi<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">member</span>   x   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span>  x   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>				<span style="color:#ec5f66;font-style:italic;">t</span><br>				<span style="color:#5fb4b4;">(</span>multi<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">member</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""	-----------------		Second way		-----------------	"""<br><br>Now count them :      'x      '<span style="color:#5fb4b4;">(</span>a b <span style="color:#5fb4b4;">(</span>c x<span style="color:#5fb4b4;">)</span> x <span style="color:#c695c6;">d</span> e<span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">multi-member_c</span>  <span style="color:#5fb4b4;">(</span>x   y  counter<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> y<span style="color:#5fb4b4;">)</span><br>		 counter<br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>multi<span style="color:#f97b58;">-</span>member_c   x   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  counter <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span>  x   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span>multi<span style="color:#f97b58;">-</span>member_c  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span>multi<span style="color:#f97b58;">-</span>member_c  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  counter<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""	-----------------		Third way		-----------------	"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">multi-member_c2</span>  <span style="color:#5fb4b4;">(</span>x   y  counter<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> y<span style="color:#5fb4b4;">)</span>						counter<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span>multi<span style="color:#f97b58;">-</span>member_c2   x   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  counter <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span>  x   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>			<span style="color:#5fb4b4;">(</span>multi<span style="color:#f97b58;">-</span>member_c2   x   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>                  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 							<span style="color:#5fb4b4;">(</span>multi<span style="color:#f97b58;">-</span>member_c2   x   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>                  counter<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.23					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a recursive member procedure that checks whether a given item is found in<br>the given list. The item is not required to be a top-most element. Some sample<br>interactions are as follows:<br><br>* <span style="color:#5fb4b4;">(</span>rec<span style="color:#f97b58;">-</span>mem    'a    '<span style="color:#5fb4b4;">(</span>b <span style="color:#5fb4b4;">(</span>z <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">a</span><span style="color:#5fb4b4;">"</span> x<span style="color:#5fb4b4;">)</span> k<span style="color:#5fb4b4;">)</span> c<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>T <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">rec-mem</span>  <span style="color:#5fb4b4;">(</span>x   y  counter<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span>    													counter<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span>  	   			<span style="color:#5fb4b4;">(</span>rec<span style="color:#f97b58;">-</span>mem   x    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>	      <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>      	                            <span style="color:#5fb4b4;">(</span>rec<span style="color:#f97b58;">-</span>mem   x    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>      counter <span style="color:#5fb4b4;">)</span>      <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>						   						<span style="color:#5fb4b4;">(</span>rec<span style="color:#f97b58;">-</span>mem     x    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>    counter<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">if </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">use </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">name </span><span style="color:#a6acb9;">"count" </span><span style="color:#a6acb9;">instead </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">"counter" </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">may </span><span style="color:#a6acb9;">give </span><span style="color:#a6acb9;">error. </span><span style="color:#a6acb9;">Because </span><span style="color:#a6acb9;">"count" </span><span style="color:#a6acb9;">is </span><span style="color:#a6acb9;">an </span><span style="color:#a6acb9;">inbuilt </span><span style="color:#a6acb9;">function: </span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">count </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">'(1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">) </span><span style="color:#a6acb9;">)</span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give</span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">3</span><br><br><br><br>"""	-----------------		Second way		-----------------	"""<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">flat_it</span>  <span style="color:#5fb4b4;">(</span>lst storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>						storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span>flat_it  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  storage <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 								<span style="color:#5fb4b4;">(</span>flat_it  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">rec-mem2_</span>  <span style="color:#5fb4b4;">(</span>x lst<span style="color:#5fb4b4;">)</span><br>		<br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>							<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span>  <span style="color:#f9ae58;">1</span>  <span style="color:#5fb4b4;">(</span>rec<span style="color:#f97b58;">-</span>mem2_ x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 								<span style="color:#5fb4b4;">(</span>rec<span style="color:#f97b58;">-</span>mem2_ x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">rec-mem2</span>  <span style="color:#5fb4b4;">(</span>x lst<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span>rec<span style="color:#f97b58;">-</span>mem2_  x <span style="color:#5fb4b4;">(</span>flat_it lst <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.24					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a procedure LEVEL, that takes an element X and a list LST, and returns the<br>level of depth that X is found in LST. If X is not a member, your procedure will<br>return NIL. Top level counts as 0, every level of nesting adds 1 to the depth. Sample<br>interaction:<br><br>* <span style="color:#5fb4b4;">(</span>level    'a    '<span style="color:#5fb4b4;">(</span>b a c<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>0<br><br>* <span style="color:#5fb4b4;">(</span>level    'a    '<span style="color:#5fb4b4;">(</span>b <span style="color:#5fb4b4;">(</span>z <span style="color:#5fb4b4;">(</span>a x<span style="color:#5fb4b4;">)</span> k<span style="color:#5fb4b4;">)</span> c<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <br>2<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">level</span>  <span style="color:#5fb4b4;">(</span>x   y  depth<span style="color:#5fb4b4;">)</span><br>	<br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<br>			<span style="color:#5fb4b4;">(</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span>										<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>           					depth<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>							<span style="color:#5fb4b4;">(</span>level x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> depth<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 								<span style="color:#5fb4b4;">(</span>level x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> depth <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""	-----------------		Second way		-----------------	"""<br><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">level2    </span><span style="color:#a6acb9;">'a    </span><span style="color:#a6acb9;">'(b </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">z </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">x) </span><span style="color:#a6acb9;">k) </span><span style="color:#a6acb9;">c)   </span><span style="color:#a6acb9;">0) </span><span style="color:#a6acb9;">					</span><span style="color:#a6acb9;">; </span><span style="color:#a6acb9;">********************************************  </span><span style="color:#a6acb9;">One </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">Best </span><span style="color:#a6acb9;">!</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">level2</span>  <span style="color:#5fb4b4;">(</span>x lst counter<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>											<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>		<br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> lst  x<span style="color:#5fb4b4;">)</span>										counter<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> lst x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 			<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> lst<span style="color:#5fb4b4;">)</span>            									<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Very </span><span style="color:#a6acb9;">important </span><span style="color:#a6acb9;">! </span><span style="color:#a6acb9;">Outputs </span><span style="color:#a6acb9;">can </span><span style="color:#a6acb9;">be </span><span style="color:#a6acb9;">either </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">non-nil </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">counter) </span><span style="color:#a6acb9;">or </span><span style="color:#a6acb9;">NIL </span><br>			 <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">or</span> 														<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">OR </span><span style="color:#a6acb9;">always </span><span style="color:#a6acb9;">searches </span><span style="color:#a6acb9;">for </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">non-nil. </span><span style="color:#a6acb9;">Set </span><span style="color:#a6acb9;">"what </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">dont </span><span style="color:#a6acb9;">need" </span><span style="color:#a6acb9;">as </span><span style="color:#a6acb9;">NIL </span><span style="color:#a6acb9;">values</span><br>			 	<span style="color:#5fb4b4;">(</span>level2   x   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span>  	counter<span style="color:#5fb4b4;">)</span><br>			 	<span style="color:#5fb4b4;">(</span>level2   x   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			 <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.25					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a procedure that converts a binary number <span style="color:#5fb4b4;">(</span>given <span style="color:#c695c6;">as</span> a <span style="color:#6699cc;font-style:italic;">list</span> of 0s <span style="color:#f97b58;">and</span> 1s<span style="color:#5fb4b4;">)</span> to<br>decimal, without checking the length of the input.<br><br><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>   ->   2^0 x 1   +   2^1  x 0  +   2^2  x  1   =   1  +  0  +  4  =  5<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">get_reverse</span>  <span style="color:#5fb4b4;">(</span>x storage<span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span><br>			 storage<br>			<span style="color:#5fb4b4;">(</span>get_reverse  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span>  x<span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span>										<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">********************************************  </span><span style="color:#a6acb9;">One </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">Best </span><span style="color:#a6acb9;">Questions </span><span style="color:#a6acb9;">!</span><br>		<br><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span>    ->   <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>		<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">binary_to_decimal</span>   <span style="color:#5fb4b4;">(</span>y    res_as_dec   power<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span><br>		res_as_dec<br>		<span style="color:#5fb4b4;">(</span>binary_to_decimal   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> res_as_dec <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span>  y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">expt</span>  <span style="color:#f9ae58;">2</span>  power<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> power <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">bin_to_dec</span>   <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span>	<span style="color:#5fb4b4;">(</span>	<span style="color:#5fb4b4;">(</span> reverse_					<span style="color:#5fb4b4;">(</span>get_reverse  x   <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span>	<span style="color:#5fb4b4;">)</span><br>	<br>				<span style="color:#5fb4b4;">(</span>binary_to_decimal   reverse_    <span style="color:#f9ae58;">0</span>    <span style="color:#f9ae58;">0</span>  <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br>	<br>	<br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.26					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a procedure ENUMERATE that enumerates a list of items. Numeration starts<br>with 0. Define two versions, one with, and one without an accumulator.<br><br><span style="color:#5fb4b4;">(</span> enumerate '<span style="color:#5fb4b4;">(</span> A B C <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span> A <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> B <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> C <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span> enumerate <span style="color:#ec5f66;font-style:italic;">NIL</span> <span style="color:#5fb4b4;">)</span><br><br>NIL<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">enumerate</span>  <span style="color:#5fb4b4;">(</span>x  counter storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span><br>		storage<br>		<span style="color:#5fb4b4;">(</span>enumerate  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  counter   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span> <br>		<br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">add </span><span style="color:#a6acb9;">from </span><span style="color:#a6acb9;">right </span><span style="color:#a6acb9;">to </span><span style="color:#a6acb9;">left, </span><span style="color:#a6acb9;">first </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">append  </span><span style="color:#a6acb9;">nil  </span><span style="color:#a6acb9;">list </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">0 </span><span style="color:#a6acb9;">A) </span><span style="color:#a6acb9;">)   </span><span style="color:#a6acb9;">=   </span><span style="color:#a6acb9;">(  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">0 </span><span style="color:#a6acb9;">A)  </span><span style="color:#a6acb9;">) </span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">     </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">append   </span><span style="color:#a6acb9;">( </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">0 </span><span style="color:#a6acb9;">A) </span><span style="color:#a6acb9;">)   </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">list  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">B) </span><span style="color:#a6acb9;">))    </span><span style="color:#a6acb9;">=   </span><span style="color:#a6acb9;">(  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">0 </span><span style="color:#a6acb9;">A)  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">B) </span><span style="color:#a6acb9;">)</span><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">enumerate2</span>  <span style="color:#5fb4b4;">(</span>x   counter<span style="color:#5fb4b4;">)</span> <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span><br>		 <span style="color:#ec5f66;font-style:italic;">nil</span><br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  counter   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span>enumerate2  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span>  counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><br>				<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">0 </span><span style="color:#a6acb9;">A)  </span><span style="color:#a6acb9;">)  </span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""#----------------------		Third Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span> enumerate '<span style="color:#5fb4b4;">(</span> A B C <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span> A <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> B <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> C <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">enumerate3</span>  <span style="color:#5fb4b4;">(</span>lst counter storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> counter <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><br>	 		<span style="color:#5fb4b4;">(</span>enumerate3 lst <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> counter <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> counter lst<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>	<br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.27					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Given a possibly nested list of symbols one and only one of which will be the<br>symbol X, compute the steps of CARs and CDRs required to get X from the list.<br><br>CL-USER > 	<span style="color:#5fb4b4;">(</span> foo <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span> a <span style="color:#5fb4b4;">(</span> z x <span style="color:#c695c6;">d</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span> c s <span style="color:#c695c6;">d</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#6699cc;font-style:italic;">CAR</span> <span style="color:#6699cc;font-style:italic;">CDR</span> <span style="color:#6699cc;font-style:italic;">CAR</span> <span style="color:#6699cc;font-style:italic;">CDR</span> <span style="color:#6699cc;font-style:italic;">CAR</span> <span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">find_x_position</span> <span style="color:#5fb4b4;">(</span>x listx &amp;optional path<span style="color:#5fb4b4;">)</span>			<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">if </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">dont </span><span style="color:#a6acb9;">specify </span><span style="color:#a6acb9;">nil </span><span style="color:#a6acb9;">here, </span><span style="color:#a6acb9;">instead </span><span style="color:#a6acb9;">if </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">do </span><span style="color:#a6acb9;">below </span><span style="color:#a6acb9;">inside </span><span style="color:#a6acb9;">car </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">cdr</span><br>														<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">go </span><span style="color:#a6acb9;">into </span><span style="color:#a6acb9;">infinite </span><span style="color:#a6acb9;">loop</span><br>  <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>		<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> listx<span style="color:#5fb4b4;">)</span> 			<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>         		 <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">OR </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">skip </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">NILs</span><br>    		<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">eq</span> x listx<span style="color:#5fb4b4;">)</span>		 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> path<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>	 <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">You </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">either </span><span style="color:#a6acb9;">encounter </span><span style="color:#a6acb9;">NIL </span><span style="color:#a6acb9;">or </span><span style="color:#a6acb9;">X </span><span style="color:#a6acb9;">at </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">end </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">all </span><span style="color:#a6acb9;">path</span><br>    		<br>    		<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> listx<span style="color:#5fb4b4;">)</span><br><br>      			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">or</span><br>        <br>        		<span style="color:#5fb4b4;">(</span>find_x_position x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> listx<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#6699cc;font-style:italic;">CAR</span> path<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>        <br>        		<span style="color:#5fb4b4;">(</span>find_x_position x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> listx<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#6699cc;font-style:italic;">CDR</span> path<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>        		<span style="color:#5fb4b4;">)</span><br>        	<span style="color:#5fb4b4;">)</span><br>        <span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">;; </span><span style="color:#a6acb9;">The </span><span style="color:#a6acb9;">reason </span><span style="color:#a6acb9;">why </span><span style="color:#a6acb9;">this </span><span style="color:#a6acb9;">code </span><span style="color:#a6acb9;">works </span><span style="color:#a6acb9;">is </span><span style="color:#a6acb9;">that </span><span style="color:#a6acb9;">"or" </span><span style="color:#a6acb9;">searches </span><span style="color:#a6acb9;">for </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">"non-nil"  </span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">most </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">this </span><span style="color:#a6acb9;">, </span><span style="color:#a6acb9;">bifurcations, </span><span style="color:#a6acb9;">or </span><span style="color:#a6acb9;">paths, </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">end </span><span style="color:#a6acb9;">up </span><span style="color:#a6acb9;">with </span><span style="color:#a6acb9;">nil.</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">but, </span><span style="color:#a6acb9;">if </span><span style="color:#a6acb9;">at </span><span style="color:#a6acb9;">least </span><span style="color:#a6acb9;">one </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">reach </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">non-nil, </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return </span><span style="color:#a6acb9;">"path"</span><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">find_x_position2</span> <span style="color:#5fb4b4;">(</span>x listx &amp;optional path<span style="color:#5fb4b4;">)</span><br><br>  <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>		<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> listx<span style="color:#5fb4b4;">)</span> 									<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>         		 <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">OR </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">skip </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">NILs</span><br>    		<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">eq</span> x listx<span style="color:#5fb4b4;">)</span>		 							<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> path<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>	 <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">You </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">either </span><span style="color:#a6acb9;">encounter </span><span style="color:#a6acb9;">NIL </span><span style="color:#a6acb9;">or </span><span style="color:#a6acb9;">X </span><span style="color:#a6acb9;">at </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">end </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">all </span><span style="color:#a6acb9;">path</span><br>    		<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> listx<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">eq</span> x listx<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>	<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>    		<br>    		<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span><br><br>      			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">or</span><br>        <br>        		<span style="color:#5fb4b4;">(</span>find_x_position2 x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> listx<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#6699cc;font-style:italic;">CAR</span> path<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>        <br>        		<span style="color:#5fb4b4;">(</span>find_x_position2 x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> listx<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#6699cc;font-style:italic;">CDR</span> path<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>        		<span style="color:#5fb4b4;">)</span><br>        	<span style="color:#5fb4b4;">)</span><br>        <span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.28					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a procedure NESTEDP that takes a list and returns T if at least one of its<br>elements is a list, and returns NIL otherwise.<br><br>* <span style="color:#5fb4b4;">(</span>nestedp  '<span style="color:#5fb4b4;">(</span> a b <span style="color:#5fb4b4;">(</span>c<span style="color:#5fb4b4;">)</span> <span style="color:#c695c6;">d</span> e<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">nestedp</span>   <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span>				<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>		<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>						<span style="color:#5fb4b4;">(</span>nestedp  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">nestedp2</span>   <span style="color:#5fb4b4;">(</span>x &amp;key <span style="color:#5fb4b4;">(</span>path 'cdr_<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span>											<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>	<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">do </span><span style="color:#a6acb9;">not </span><span style="color:#a6acb9;">use </span><span style="color:#a6acb9;">ENDP. </span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> path 'car_<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> x<span style="color:#5fb4b4;">)</span>						<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">or</span> <br>				<span style="color:#5fb4b4;">(</span>nestedp2   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  :path  'car_ <span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span>nestedp2   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  :path  'cdr_<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.29					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Define a recursive function FLATTEN, which takes a possibly nested list and re-<br>turns a version where all nesting is eliminated. E.g. <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">4</span> <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">7</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>should be returned as <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">6</span> <span style="color:#f9ae58;">7</span><span style="color:#5fb4b4;">)</span>.<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">flatten</span> <span style="color:#5fb4b4;">(</span>x   storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span>  x<span style="color:#5fb4b4;">)</span>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span>flatten   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  storage <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>								<span style="color:#5fb4b4;">(</span>flatten   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""--------------------------------------------------------------------------------------"""<br>"""------------------					Exercise 4.30					-----------------"""<br>"""--------------------------------------------------------------------------------------"""<br><br>Write a program named RANGE, that takes a non-negative integer N as argument and<br>returns a list of non-negative integers that are less than N in increasing order. Here<br>is a sample interaction with the first four non-negative integers, your solution must<br>work for all non-negative integers:<br><br><span style="color:#5fb4b4;">(</span> range <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span>		-> 		NIL<br><span style="color:#5fb4b4;">(</span> range <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>		->  	<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">(</span> range <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> 		-> 		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">range</span> <span style="color:#5fb4b4;">(</span>x   storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">eq</span> x <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> 				<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">eq</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#f9ae58;">0</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>						<span style="color:#5fb4b4;">(</span>range  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br>		<br>"""#----------------------		Second Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">range-2</span>  <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">eq</span> x <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> 				<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">eq</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  <span style="color:#5fb4b4;">(</span>range<span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.31					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>Write a program that takes a sequence, a start index, an end index and returns the<br>sub-sequence from start to <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> including<span style="color:#5fb4b4;">)</span> end. Indices start from 0.<br><br>'<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span> a b c     <span style="color:#c695c6;">d</span> e <span style="color:#6699cc;font-style:italic;">f</span>    g h <span style="color:#5fb4b4;">)</span>	<span style="color:#f9ae58;">3</span>  <span style="color:#f9ae58;">5</span>   <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>			->	    <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span> e <span style="color:#6699cc;font-style:italic;">f</span><span style="color:#5fb4b4;">)</span>	<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">sub-sequence</span> <span style="color:#5fb4b4;">(</span>x   start   end    storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span> 									storage  <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> start <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> end <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x <span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> start <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span>								<span style="color:#5fb4b4;">(</span>sub<span style="color:#f97b58;">-</span>sequence <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   start   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> end <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>											<span style="color:#5fb4b4;">(</span>sub<span style="color:#f97b58;">-</span>sequence <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> start <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> end <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>   storage <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>		<br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">sub-seq</span>  <span style="color:#5fb4b4;">(</span>x  start  end <span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span>sub<span style="color:#f97b58;">-</span>sequence x   start   end   <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br>'<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span> a b c     <span style="color:#c695c6;">d</span> e <span style="color:#6699cc;font-style:italic;">f</span>    g h <span style="color:#5fb4b4;">)</span>	<span style="color:#f9ae58;">3</span>  <span style="color:#f9ae58;">5</span>   <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>			->	    <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span> e <span style="color:#6699cc;font-style:italic;">f</span><span style="color:#5fb4b4;">)</span>	<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">sub-seq2</span>   <span style="color:#5fb4b4;">(</span>x   start  end  storage <span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> start end<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> start x<span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <br>				<span style="color:#5fb4b4;">(</span>sub<span style="color:#f97b58;">-</span>seq2  x  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> start <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  end  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> start x<span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.32					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>Define a procedure REMOVE2 that takes an element and a list, and returns a list<br>where all the occurrences of the element are removed from the list.<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">remove-2</span>  <span style="color:#5fb4b4;">(</span>x   y  storage<span style="color:#5fb4b4;">)</span>     <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">x </span><span style="color:#a6acb9;">x </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">x)  </span><span style="color:#a6acb9;">remove </span><span style="color:#a6acb9;">all </span><span style="color:#a6acb9;">x </span><span style="color:#a6acb9;">s </span><span style="color:#a6acb9;">inside </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">list </span><span style="color:#a6acb9;">y</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">eq</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">remove-3</span>  <span style="color:#5fb4b4;">(</span>x y storage<span style="color:#5fb4b4;">)</span>		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">x </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">x </span><span style="color:#a6acb9;">v) </span><span style="color:#a6acb9;">v </span><span style="color:#a6acb9;">) </span><span style="color:#a6acb9;">h)  </span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span>								storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span><span style="color:#f9ae58;">3</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">eq</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span><span style="color:#f9ae58;">3</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>										<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span><span style="color:#f9ae58;">3</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">remove-4</span>  <span style="color:#5fb4b4;">(</span>x y storage<span style="color:#5fb4b4;">)</span>		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">( </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">a) </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">x </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">x </span><span style="color:#a6acb9;">v) </span><span style="color:#a6acb9;">v </span><span style="color:#a6acb9;">) </span><span style="color:#a6acb9;">h)  </span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span>								storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span><span style="color:#f9ae58;">4</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">eq</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span><span style="color:#f9ae58;">4</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>										<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span><span style="color:#f9ae58;">4</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.33					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>Write a program that takes two parameters count and max, and returns a list of<br>count random integers, all less than max.<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">produce</span> <span style="color:#5fb4b4;">(</span>count_   max_  &amp;optional <span style="color:#5fb4b4;">(</span>counter <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>storage <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">&lt;</span> counter count_<span style="color:#5fb4b4;">)</span> 			<span style="color:#5fb4b4;">(</span>produce count_  max_ <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">random</span> max_<span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>								storage<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">produce2</span> <span style="color:#5fb4b4;">(</span>count_ max_<span style="color:#5fb4b4;">)</span> <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span> result 		<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dotimes</span> <span style="color:#5fb4b4;">(</span>i count_ result<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">random</span> max_<span style="color:#5fb4b4;">)</span> result<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.34					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>The built-in REVERSE reverses a list. Define your own version of reverse.<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">rev</span>   <span style="color:#5fb4b4;">(</span>x   &amp;optional <span style="color:#5fb4b4;">(</span>storage  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span>				storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>						<span style="color:#5fb4b4;">(</span>rev  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">rev2</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span> <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span> result 		<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dotimes</span> <span style="color:#5fb4b4;">(</span>i <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> result<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i lst<span style="color:#5fb4b4;">)</span> result<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>We will force it man ! We will force it. There is no border for us. <br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.35					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>In Ex 4.34 you defined a list reversing procedure. Now alter that definition so that<br>it not only reverses the order of the top-level elements in the list but also reverses<br>any members which are themselves lists.<br><br>Yes Sir. We can also reverse the rotation of the earth, if you want !<br><br>'<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>c <span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> b<span style="color:#5fb4b4;">)</span> c<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>a<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>     <span style="color:#5fb4b4;">(</span>func <span style="color:#6699cc;font-style:italic;">cdr</span><span style="color:#5fb4b4;">)</span>       <span style="color:#f97b58;">+</span>     <span style="color:#5fb4b4;">(</span>func <span style="color:#6699cc;font-style:italic;">car</span><span style="color:#5fb4b4;">)</span> <br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">rev3</span>  <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span>												<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">******************************************** </span><br>																<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">If </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">can </span><span style="color:#a6acb9;">visualize </span><span style="color:#a6acb9;">this </span><span style="color:#a6acb9;">path, </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">are </span><span style="color:#a6acb9;">on </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">right </span><span style="color:#a6acb9;">path </span><span style="color:#a6acb9;">!</span><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span>  							<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Note: </span><span style="color:#a6acb9;">append </span><span style="color:#a6acb9;">does </span><span style="color:#a6acb9;">not </span><span style="color:#a6acb9;">care </span><span style="color:#a6acb9;">about </span><span style="color:#a6acb9;">NIL, </span><span style="color:#a6acb9;">but </span><span style="color:#a6acb9;">values </span><span style="color:#a6acb9;">must </span><span style="color:#a6acb9;">be </span><span style="color:#a6acb9;">list</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Now, </span><span style="color:#a6acb9;">these </span><span style="color:#a6acb9;">Xs </span><span style="color:#a6acb9;">are </span><span style="color:#a6acb9;">both </span><span style="color:#a6acb9;">car </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">cdr </span><span style="color:#a6acb9;">from </span><span style="color:#a6acb9;">below</span><br><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>    <span style="color:#5fb4b4;">(</span>rev3   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span>rev3 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 									<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>    <span style="color:#5fb4b4;">(</span>rev3   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span>rev3 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>check !<br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>rev3 '<span style="color:#5fb4b4;">(</span> a b c <span style="color:#5fb4b4;">(</span>a b c <span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> a b c<span style="color:#5fb4b4;">)</span> a b c<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span>			<br><br><span style="color:#5fb4b4;">(</span>C B A <span style="color:#5fb4b4;">(</span>C B A <span style="color:#5fb4b4;">(</span>C B A<span style="color:#5fb4b4;">)</span> C B A<span style="color:#5fb4b4;">)</span> C B A<span style="color:#5fb4b4;">)</span><br><br>We will force it ...<br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">#----------------------</span><span style="color:#99c794;">		</span><span style="color:#99c794;">Second </span><span style="color:#99c794;">Way</span><span style="color:#99c794;">		</span><span style="color:#99c794;">-----------------------#</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">rev4</span>  <span style="color:#5fb4b4;">(</span>x storage<span style="color:#5fb4b4;">)</span>												<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">******************************************** </span><br>																	<br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span>  							storage<span style="color:#5fb4b4;">)</span>			<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">If </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">forget </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">NIL </span><span style="color:#a6acb9;">below, </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">print </span><span style="color:#a6acb9;">double </span><span style="color:#a6acb9;">values</span><span style="color:#a6acb9;">		</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>						x<span style="color:#5fb4b4;">)</span>					<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Because </span><span style="color:#a6acb9;">this </span><span style="color:#a6acb9;">is </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">new </span><span style="color:#a6acb9;">function</span><br><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 						<span style="color:#5fb4b4;">(</span>rev4     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>     <span style="color:#5fb4b4;">(</span>rev4 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>      	storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 									<span style="color:#5fb4b4;">(</span>rev4     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>                      storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>rev4 '<span style="color:#5fb4b4;">(</span> a b c <span style="color:#5fb4b4;">(</span>a b c <span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> a b c<span style="color:#5fb4b4;">)</span> a b c<span style="color:#5fb4b4;">)</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span>C B A <span style="color:#5fb4b4;">(</span>C B A <span style="color:#5fb4b4;">(</span>C B A<span style="color:#5fb4b4;">)</span> C B A<span style="color:#5fb4b4;">)</span> C B A<span style="color:#5fb4b4;">)</span><br><br><br><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.36</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>Define a procedure HOW<span style="color:#f97b58;">-</span>MANY? that counts the top<span style="color:#f97b58;">-</span>level occurrences of an item in a <span style="color:#6699cc;font-style:italic;">list</span>.<br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>how<span style="color:#f97b58;">-</span>many 'a '<span style="color:#5fb4b4;">(</span>a b r a c a <span style="color:#c695c6;">d</span> a b r a<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#f9ae58;">5</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">how-many</span>   <span style="color:#5fb4b4;">(</span>x   y   &amp;optional  <span style="color:#5fb4b4;">(</span>counter <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span>						counter<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span>			<span style="color:#5fb4b4;">(</span>how<span style="color:#f97b58;">-</span>many  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>								<span style="color:#5fb4b4;">(</span>how<span style="color:#f97b58;">-</span>many  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  counter <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">#----------------------</span><span style="color:#99c794;">		</span><span style="color:#99c794;">Second </span><span style="color:#99c794;">Way</span><span style="color:#99c794;">		</span><span style="color:#99c794;">-----------------------#</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>how<span style="color:#f97b58;">-</span>many2 'a '<span style="color:#5fb4b4;">(</span>a b r a c a <span style="color:#c695c6;">d</span> a b r a<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#f9ae58;">5</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">how-many2</span>   <span style="color:#5fb4b4;">(</span>x   y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span>						<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  x<span style="color:#5fb4b4;">)</span>			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span>  <span style="color:#f9ae58;">1</span>  <span style="color:#5fb4b4;">(</span>how<span style="color:#f97b58;">-</span>many2  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>								<span style="color:#5fb4b4;">(</span>how<span style="color:#f97b58;">-</span>many2 x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">#----------------------</span><span style="color:#99c794;">		</span><span style="color:#99c794;">Third </span><span style="color:#99c794;">Way </span><span style="color:#99c794;">for </span><span style="color:#99c794;">nested</span><span style="color:#99c794;">		</span><span style="color:#99c794;">-----------------------#</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>how<span style="color:#f97b58;">-</span>many3 'a '<span style="color:#5fb4b4;">(</span>a b r <span style="color:#5fb4b4;">(</span>a c <span style="color:#5fb4b4;">(</span>a<span style="color:#5fb4b4;">)</span> <span style="color:#c695c6;">d</span> a<span style="color:#5fb4b4;">)</span> b r a<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#f9ae58;">5</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">how-many3</span>   <span style="color:#5fb4b4;">(</span>x   y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span>						<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 				<span style="color:#5fb4b4;">(</span>how<span style="color:#f97b58;">-</span>many3 x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  x<span style="color:#5fb4b4;">)</span>			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span>  <span style="color:#f9ae58;">1</span>  <span style="color:#5fb4b4;">(</span>how<span style="color:#f97b58;">-</span>many3  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>								<span style="color:#5fb4b4;">(</span>how<span style="color:#f97b58;">-</span>many3 x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.37</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>Define a recursive procedure <span style="color:#c695c6;">D</span><span style="color:#f97b58;">-</span>HOW<span style="color:#f97b58;">-</span>MANY? that counts all – <span style="color:#f97b58;">not</span> only top<span style="color:#f97b58;">-</span>level –<br>occurrences of an item in a <span style="color:#6699cc;font-style:italic;">list</span>.<br><span style="color:#c695c6;">For</span> instance <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">D</span><span style="color:#f97b58;">-</span>HOW<span style="color:#f97b58;">-</span>MANY? 'A '<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A B<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>C <span style="color:#5fb4b4;">(</span>A X<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> A<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> should <span style="color:#c695c6;">return</span> <span style="color:#f9ae58;">3</span>.<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">d-how-many</span>  <span style="color:#5fb4b4;">(</span>x   y   &amp;optional  <span style="color:#5fb4b4;">(</span>counter  <span style="color:#f9ae58;">0</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span>						counter <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span><span style="color:#f97b58;">-</span>how<span style="color:#f97b58;">-</span>many  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  counter<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">counter</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span><span style="color:#f97b58;">-</span>how<span style="color:#f97b58;">-</span>many  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>								<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span><span style="color:#f97b58;">-</span>how<span style="color:#f97b58;">-</span>many  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>   counter<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">;; </span><span style="color:#a6acb9;">VERY </span><span style="color:#a6acb9;">IMPORTANT </span><span style="color:#a6acb9;">: </span><span style="color:#a6acb9;">if </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">use </span><span style="color:#a6acb9;">&amp;optional </span><span style="color:#a6acb9;">, </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">be </span><span style="color:#a6acb9;">very </span><span style="color:#a6acb9;">careful. </span><span style="color:#a6acb9;">Because </span><span style="color:#a6acb9;">every </span><span style="color:#a6acb9;">time </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">forgot </span><span style="color:#a6acb9;">to </span><span style="color:#a6acb9;">enter </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">value </span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">enter </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">optional </span><span style="color:#a6acb9;">value </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">pre-determined </span><span style="color:#a6acb9;">value) </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">zero </span><span style="color:#a6acb9;">here). </span><span style="color:#a6acb9;">Therefore, </span><span style="color:#a6acb9;">nesting </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">be </span><span style="color:#a6acb9;">meaningless.</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">It </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">not </span><span style="color:#a6acb9;">count.</span><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">#----------------------</span><span style="color:#99c794;">		</span><span style="color:#99c794;">Second </span><span style="color:#99c794;">Way</span><span style="color:#99c794;">		</span><span style="color:#99c794;">-----------------------#</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">d-how-many-2</span>   <span style="color:#5fb4b4;">(</span>x   y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span>						<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span><span style="color:#f97b58;">-</span>how<span style="color:#f97b58;">-</span>many<span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span> x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span>  <span style="color:#f9ae58;">1</span>  <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span><span style="color:#f97b58;">-</span>how<span style="color:#f97b58;">-</span>many<span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span> x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>								<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span><span style="color:#f97b58;">-</span>how<span style="color:#f97b58;">-</span>many<span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span> x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>		<br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br>			<br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.38</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br><br>Define a three argument procedure <span style="color:#6699cc;font-style:italic;">REMOVE</span><span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">NTH</span>, which removes <span style="color:#6699cc;font-style:italic;">every</span> <span style="color:#6699cc;font-style:italic;">nth</span> occurrence of an item <span style="color:#c695c6;">from</span> a <span style="color:#6699cc;font-style:italic;">list</span>.<br><br>'x    <span style="color:#f9ae58;">2</span>   '<span style="color:#5fb4b4;">(</span> a x X b b x c X <span style="color:#c695c6;">d</span> <span style="color:#c695c6;">d</span> x X <span style="color:#5fb4b4;">)</span>			<span style="color:#f97b58;">-</span><span style="color:#f97b58;">></span>		'<span style="color:#5fb4b4;">(</span> a x _ b b x c _ <span style="color:#c695c6;">d</span> <span style="color:#c695c6;">d</span> x _ <span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">remove-</span>   <span style="color:#5fb4b4;">(</span>x  nt  lst  counter storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> lst<span style="color:#5fb4b4;">)</span>												storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> counter  nt<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span>  x  nt  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span>  <span style="color:#f9ae58;">1</span>    storage<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span> <br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span> 									<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span>  x  nt  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>														<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span>  x  nt  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span>  counter        <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">remove-nth</span>  <span style="color:#5fb4b4;">(</span>x nt lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">remove</span><span style="color:#f97b58;">-</span>  x  nt  lst  <span style="color:#f9ae58;">1</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">#----------------------</span><span style="color:#99c794;">		</span><span style="color:#99c794;">Second </span><span style="color:#99c794;">Way</span><span style="color:#99c794;">		</span><span style="color:#99c794;">-----------------------#</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>'x    <span style="color:#f9ae58;">3</span>   '<span style="color:#5fb4b4;">(</span> a x x X   b b x x c X <span style="color:#c695c6;">d</span> <span style="color:#c695c6;">d</span> x  x X <span style="color:#5fb4b4;">)</span>			<span style="color:#f97b58;">-</span><span style="color:#f97b58;">></span>		'<span style="color:#5fb4b4;">(</span> a x x _ b b x x c _ <span style="color:#c695c6;">d</span> <span style="color:#c695c6;">d</span> x x _ <span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">remove-2</span> <span style="color:#5fb4b4;">(</span>x nt lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span> <br>			  <span style="color:#5fb4b4;">(</span>counter 					<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>			  <span style="color:#5fb4b4;">(</span>storage  				<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>			  <span style="color:#5fb4b4;">(</span>nt  						<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> nt <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>	<br>			 <span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dotimes</span>	<span style="color:#5fb4b4;">(</span>i <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i lst<span style="color:#5fb4b4;">)</span>  x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> counter nt<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> counter <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i lst<span style="color:#5fb4b4;">)</span>  x<span style="color:#5fb4b4;">)</span>									<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <br>																				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> counter 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>																				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> storage 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>															<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> storage 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>	<br>			<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>Everything is about <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">ALL</span><span style="color:#5fb4b4;">"</span> probabilities ! Consider ALL. <br><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.39</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>A given <span style="color:#6699cc;font-style:italic;">set</span> A is a subset of another <span style="color:#6699cc;font-style:italic;">set</span> B <span style="color:#c695c6;">if</span> <span style="color:#f97b58;">and</span> only <span style="color:#c695c6;">if</span> all the members of A are<br>also a <span style="color:#6699cc;font-style:italic;">member</span> of B. Two sets are equivalent, <span style="color:#c695c6;">if</span> <span style="color:#f97b58;">and</span> only <span style="color:#c695c6;">if</span> they are subsets of each<br>other. <span style="color:#c695c6;">For</span> this problem you will represent sets via lists.<br><br><span style="color:#5fb4b4;">(</span>a<span style="color:#5fb4b4;">)</span>		Define a procedure <span style="color:#6699cc;font-style:italic;">SUBSETP</span> that takes two <span style="color:#6699cc;font-style:italic;">list</span> arguments <span style="color:#f97b58;">and</span> decides<br>		whether the <span style="color:#6699cc;font-style:italic;">first</span> is a subset of the <span style="color:#6699cc;font-style:italic;">second</span>.<br><br><br>		'<span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span>     '<span style="color:#5fb4b4;">(</span>x a b x<span style="color:#5fb4b4;">)</span>   <span style="color:#f97b58;">-</span><span style="color:#f97b58;">></span>    <span style="color:#ec5f66;font-style:italic;">T</span> <br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">subset_</span>  <span style="color:#5fb4b4;">(</span> car_x    y<span style="color:#5fb4b4;">)</span>					<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">this </span><span style="color:#a6acb9;">car </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">come </span><span style="color:#a6acb9;">from </span><span style="color:#a6acb9;">below</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span>							<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> car_x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>			<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>									<span style="color:#5fb4b4;">(</span>subset_ car_x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">b)     </span><span style="color:#a6acb9;">'(x </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">x)   </span><span style="color:#a6acb9;">->    </span><span style="color:#a6acb9;">T </span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">subset-p</span> <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span> 							<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>subset_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> y<span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span>subset<span style="color:#f97b58;">-</span>p <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>									<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span>b<span style="color:#5fb4b4;">)</span> 		Define a procedure EQUIP that takes two <span style="color:#6699cc;font-style:italic;">list</span> arguments <span style="color:#f97b58;">and</span> decides<br>			whether the two are equivalent.<br><br>	<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">b)     </span><span style="color:#a6acb9;">'( </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">)   </span><span style="color:#a6acb9;">->    </span><span style="color:#a6acb9;">T </span><span style="color:#a6acb9;">		</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">equip</span>  <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span>subset<span style="color:#f97b58;">-</span>p x y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>subset<span style="color:#f97b58;">-</span>p y x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>					<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>														<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span>c<span style="color:#5fb4b4;">)</span>		Define a procedure IDENP that takes two <span style="color:#6699cc;font-style:italic;">list</span> arguments <span style="color:#f97b58;">and</span> decides<br>		whether the two have the same elements in the same order – <span style="color:#c695c6;">do</span> <span style="color:#f97b58;">not</span><br>		directly compare the lists <span style="color:#c695c6;">with</span> <span style="color:#f97b58;">EQUALP</span>, you are required <span style="color:#c695c6;">to</span> <span style="color:#c695c6;">do</span> a element<br>		by element comparison.<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">idenp</span> <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span>						<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>		<span style="color:#5fb4b4;">(</span>idenp <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>								<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.40*</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">Define </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">procedure </span><span style="color:#a6acb9;">IMPLODE </span><span style="color:#a6acb9;">that </span><span style="color:#a6acb9;">takes </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">list </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">symbols </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">replaces </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">consequently </span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">repeating </span><span style="color:#a6acb9;">symbols </span><span style="color:#a6acb9;">with </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">symbol </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">the </span><span style="color:#a6acb9;">number </span><span style="color:#a6acb9;">of </span><span style="color:#a6acb9;">its </span><span style="color:#a6acb9;">repetitions.</span><br><br>CL<span style="color:#f97b58;">-</span>USER <span style="color:#f97b58;">></span> <span style="color:#5fb4b4;">(</span> implode 	'<span style="color:#5fb4b4;">(</span> a a b c c c <span style="color:#c695c6;">d</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>						<span style="color:#5fb4b4;">(</span>A <span style="color:#f9ae58;">2</span> B <span style="color:#f9ae58;">1</span> C <span style="color:#f9ae58;">3</span> <span style="color:#c695c6;">D</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">counter-list</span> <span style="color:#5fb4b4;">(</span>x   storage   reader  counter<span style="color:#5fb4b4;">)</span>   <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">initially  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">storage </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">nil) </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">reader </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">car </span><span style="color:#a6acb9;">x) </span><span style="color:#a6acb9;">)  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">counter </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">0)    </span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> counter<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>   reader<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>counter<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">list</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   storage reader <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>counter<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">list</span>   x   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> counter<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#f9ae58;">0</span>  <span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">counter-list </span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">)  </span><span style="color:#a6acb9;">nil  </span><span style="color:#a6acb9;">'a   </span><span style="color:#a6acb9;">0 </span><span style="color:#a6acb9;">)</span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give</span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">3)  </span><span style="color:#a6acb9;">let's </span><span style="color:#a6acb9;">call </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">"list </span><span style="color:#a6acb9;">Y"</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">unique-list</span>  <span style="color:#5fb4b4;">(</span>x  storage  reader<span style="color:#5fb4b4;">)</span>	<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">initially  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">storage </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">nil) </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">reader </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">car </span><span style="color:#a6acb9;">x) </span><span style="color:#a6acb9;">) </span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span>  reader<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  reader <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>unique<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">list</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  storage  reader<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>unique<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">list</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span>  reader<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">unique-list </span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">) </span><span style="color:#a6acb9;">nil </span><span style="color:#a6acb9;">'a)</span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give</span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">D </span><span style="color:#a6acb9;">E)     </span><span style="color:#a6acb9;">let's </span><span style="color:#a6acb9;">call </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">"list </span><span style="color:#a6acb9;">X"</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">merge-them</span>  <span style="color:#5fb4b4;">(</span>x y storage<span style="color:#5fb4b4;">)</span>	<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">  </span><span style="color:#a6acb9;">"list </span><span style="color:#a6acb9;">X"   </span><span style="color:#a6acb9;">and   </span><span style="color:#a6acb9;">"list </span><span style="color:#a6acb9;">Y"  </span><span style="color:#a6acb9;">;  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">D </span><span style="color:#a6acb9;">E)   </span><span style="color:#a6acb9;">and   </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">3)  </span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span><br>		storage<br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">merge</span><span style="color:#f97b58;">-</span>them   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">implode</span>  <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">merge</span><span style="color:#f97b58;">-</span>them	<span style="color:#5fb4b4;">(</span>unique<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">list</span> x <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>	<span style="color:#5fb4b4;">(</span>counter<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">list</span> x <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span>	<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">implode </span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">) </span><span style="color:#a6acb9;">)      </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give    </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">D </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">E </span><span style="color:#a6acb9;">3) </span><br><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.41</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>Define a procedure EXPLODE that realizes the inverse of the relation realized by<br>IMPLODE. Assume that the input will <span style="color:#c695c6;">always</span> be a <span style="color:#6699cc;font-style:italic;">list</span> where each symbol is imme<span style="color:#f97b58;">-</span><br>diately followed by a number that gives its <span style="color:#6699cc;font-style:italic;">count</span> in the output.<br><br>CL<span style="color:#f97b58;">-</span>USER <span style="color:#f97b58;">></span> <span style="color:#5fb4b4;">(</span> explode '<span style="color:#5fb4b4;">(</span> a <span style="color:#f9ae58;">3</span>    b <span style="color:#f9ae58;">2</span>    c <span style="color:#f9ae58;">1</span>   <span style="color:#c695c6;">d</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span>A A A   B B    C     <span style="color:#c695c6;">D</span> <span style="color:#c695c6;">D</span> <span style="color:#c695c6;">D</span> <span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">explode_</span> <span style="color:#5fb4b4;">(</span>x  counter  storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span>									storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> counter <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 			<span style="color:#5fb4b4;">(</span>explode_   x  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>											<span style="color:#5fb4b4;">(</span>explode_    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">0</span>  storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">explode</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span>explode_ x  <span style="color:#f9ae58;">0</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.42</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>Given a sequence of 0s <span style="color:#f97b58;">and</span> 1s, <span style="color:#c695c6;">return</span> the number of 0s that are preceded by a <span style="color:#f9ae58;">0</span>.<br>Here is a sample interaction:<br><br>CL<span style="color:#f97b58;">-</span>USER <span style="color:#f97b58;">></span> <span style="color:#5fb4b4;">(</span> zeros '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">0 </span><span style="color:#99c794;">0</span><span style="color:#5fb4b4;">"</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#f9ae58;">2</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">zeros_</span>  <span style="color:#5fb4b4;">(</span>x storage change<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> change <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>			<span style="color:#5fb4b4;">(</span>zeros_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  storage change<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span>											<span style="color:#5fb4b4;">(</span>zeros_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> '<span style="color:#f9ae58;">0</span> storage<span style="color:#5fb4b4;">)</span>   <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>															<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">zeros</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> <span style="color:#5fb4b4;">(</span>zeros_ x <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.43</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>Define a procedure REMAFTER that takes an element, a <span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#f97b58;">and</span> a pivot element <span style="color:#f97b58;">and</span><br>returns a <span style="color:#6699cc;font-style:italic;">list</span> where all the occurrences of the element that are preceded by the pivot<br>element are removed <span style="color:#c695c6;">from</span> the <span style="color:#6699cc;font-style:italic;">list</span>.<br><br>'x    'p    '<span style="color:#5fb4b4;">(</span> a p <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">x</span><span style="color:#5fb4b4;">"</span> b X c p <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">x</span><span style="color:#5fb4b4;">"</span> <span style="color:#c695c6;">d</span> a<span style="color:#5fb4b4;">)</span>     	<span style="color:#f97b58;">-</span><span style="color:#f97b58;">></span>		 '<span style="color:#5fb4b4;">(</span> a p _ b X c p _ <span style="color:#c695c6;">d</span> a<span style="color:#5fb4b4;">)</span> <br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">remafter_</span> <span style="color:#5fb4b4;">(</span>x   y   pivot  storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> y<span style="color:#5fb4b4;">)</span>							storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> pivot<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>		<span style="color:#5fb4b4;">(</span>remafter_ x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> pivot    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span>			<span style="color:#5fb4b4;">(</span>remafter_ x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> pivot <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>									<span style="color:#5fb4b4;">(</span>remafter_ x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>   pivot  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> y<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">remafter</span> <span style="color:#5fb4b4;">(</span>x y pivot<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span>remafter_ x y pivot <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">#----------------------</span><span style="color:#99c794;">		</span><span style="color:#99c794;">Second </span><span style="color:#99c794;">Way</span><span style="color:#99c794;">		</span><span style="color:#99c794;">-----------------------#</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>'x    'p    '<span style="color:#5fb4b4;">(</span> a p <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">x</span><span style="color:#5fb4b4;">"</span> b X c p <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">x</span><span style="color:#5fb4b4;">"</span> <span style="color:#c695c6;">d</span> a<span style="color:#5fb4b4;">)</span>     	<span style="color:#f97b58;">-</span><span style="color:#f97b58;">></span>		 '<span style="color:#5fb4b4;">(</span> a p _ b X c p _ <span style="color:#c695c6;">d</span> a<span style="color:#5fb4b4;">)</span> <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">remafter-2</span>   <span style="color:#5fb4b4;">(</span>x lst pivot storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  lst storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>lst1							 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cadr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>      <br>			 		 <span style="color:#5fb4b4;">(</span>lst2 							 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> pivot x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			 		 <span style="color:#5fb4b4;">(</span>cr 							 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>					<br>			 		<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>					 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span>  lst1 lst2<span style="color:#5fb4b4;">)</span>    		 <span style="color:#5fb4b4;">(</span>remafter<span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span> x    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> cr<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cddr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   pivot    storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 							 <span style="color:#5fb4b4;">(</span>remafter<span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span> x    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span>             pivot     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> cr storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.44</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>The mean of n numbers is computed by dividing their <span style="color:#6699cc;font-style:italic;">sum</span> by n. A running mean<br>is a mean that gets updated <span style="color:#c695c6;">as</span> we encounter more numbers. Observe the following<br>input<span style="color:#f97b58;">-</span>output sequences:<br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>run<span style="color:#f97b58;">-</span>mean '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">7</span> <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			 <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">run-mean_</span> <span style="color:#5fb4b4;">(</span>x   storage  mean   counter<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>						<span style="color:#5fb4b4;">(</span>run<span style="color:#f97b58;">-</span>mean_  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">/</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> mean  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>   counter<span style="color:#5fb4b4;">)</span>  storage<span style="color:#5fb4b4;">)</span>    <br>								     <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">/</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> mean  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>   counter<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">run-mean</span>  <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span>run<span style="color:#f97b58;">-</span>mean_ x <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">#----------------------</span><span style="color:#99c794;">		</span><span style="color:#99c794;">Second </span><span style="color:#99c794;">Way</span><span style="color:#99c794;">		</span><span style="color:#99c794;">-----------------------#</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br>		<br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>run<span style="color:#f97b58;">-</span>mean '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">7</span> <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			 <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">run-mean_2</span> <span style="color:#5fb4b4;">(</span>x storage mean counter<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dotimes</span>	<span style="color:#5fb4b4;">(</span>i     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> x<span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>	<br>    			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>new<span style="color:#f97b58;">-</span>mean 		<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">/</span>      <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i x<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> mean <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>     counter<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>    			<br>      					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> storage 		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> new<span style="color:#f97b58;">-</span>mean storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>     					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> mean 			new<span style="color:#f97b58;">-</span>mean<span style="color:#5fb4b4;">)</span><br>     					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> counter 		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span><span style="color:#f97b58;">+</span> counter<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>    	<span style="color:#5fb4b4;">)</span><br>    	<br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">run-mean2</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br>  <span style="color:#5fb4b4;">(</span>run<span style="color:#f97b58;">-</span>mean_2 x <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.45</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>A chain in a sequence of numbers is such that each number in the chain is either<br><span style="color:#f97b58;">equal</span> <span style="color:#c695c6;">to</span> <span style="color:#f97b58;">or</span> greater than the one before it. <span style="color:#c695c6;">For</span> instance, <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">9</span> <span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">17</span> <span style="color:#f9ae58;">21</span> is a chain,<br>but <span style="color:#f97b58;">not</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">9</span> <span style="color:#f9ae58;">17</span> <span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">21</span>, because the <span style="color:#f9ae58;">17</span> <span style="color:#f9ae58;">12</span> sub<span style="color:#f97b58;">-</span>sequence breaks the chain. Define<br>a recursive procedure that finds <span style="color:#f97b58;">and</span> returns the longest chain in a sequence of<br>numbers. <span style="color:#c695c6;">If</span> there are more than one sequences <span style="color:#c695c6;">with</span> the highest <span style="color:#6699cc;font-style:italic;">length</span>, <span style="color:#c695c6;">return</span><br>the one you encountered <span style="color:#6699cc;font-style:italic;">first</span>. Here are <span style="color:#6699cc;font-style:italic;">some</span> sample interactions:<br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>longest<span style="color:#f97b58;">-</span>chain '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span> <span style="color:#f9ae58;">25</span> <span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>longest<span style="color:#f97b58;">-</span>chain '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span> <span style="color:#f9ae58;">25</span> <span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">34</span> <span style="color:#f9ae58;">42</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">34</span> <span style="color:#f9ae58;">42</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>longest<span style="color:#f97b58;">-</span>chain '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span> <span style="color:#f9ae58;">25</span> <span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">34</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">give_first</span>  <span style="color:#5fb4b4;">(</span>x  storage<span style="color:#5fb4b4;">)</span> <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span>								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">&lt;=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> 			<span style="color:#5fb4b4;">(</span>give_first <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>										<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">give_first </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14   </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6   </span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">7) </span><span style="color:#a6acb9;">nil)</span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return </span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">give_remain</span>  <span style="color:#5fb4b4;">(</span>g_f  x <span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> g_f<span style="color:#5fb4b4;">)</span>			x<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> g_f<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span>give_remain <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> g_f<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>										<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">ERROR </span><span style="color:#99c794;">! </span><span style="color:#99c794;">Two </span><span style="color:#99c794;">lists </span><span style="color:#99c794;">are </span><span style="color:#99c794;">different!</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">give_remain </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14 </span><span style="color:#a6acb9;">) </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14   </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6 </span><span style="color:#a6acb9;">9   </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">7) </span><span style="color:#a6acb9;">)</span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return</span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6 </span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">7)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">main_</span>  <span style="color:#5fb4b4;">(</span>x   storage<span style="color:#5fb4b4;">)</span> <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span><span style="color:#f97b58;">*</span>	<span style="color:#5fb4b4;">(</span>										<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">let* </span><span style="color:#a6acb9;">works </span><span style="color:#a6acb9;">"sequential" </span><span style="color:#a6acb9;">which </span><span style="color:#a6acb9;">means </span><span style="color:#a6acb9;">that </span><span style="color:#a6acb9;">you </span><span style="color:#a6acb9;">can </span><span style="color:#a6acb9;">use </span><span style="color:#a6acb9;">assigned </span><span style="color:#a6acb9;">values </span><span style="color:#a6acb9;">later</span><br>			<span style="color:#5fb4b4;">(</span> first_			<span style="color:#5fb4b4;">(</span>give_first  x  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> remain_			<span style="color:#5fb4b4;">(</span>give_remain first_ x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> remain<span style="color:#5fb4b4;">)</span>									storage<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">&lt;</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> first_<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>			<span style="color:#5fb4b4;">(</span>main_  remain  first_<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>												<span style="color:#5fb4b4;">(</span>main_  remain  storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>    <span style="color:#5fb4b4;">main</span>  <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span>main_  x  <span style="color:#5fb4b4;">(</span>give_first  x  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">#----------------------</span><span style="color:#99c794;">		</span><span style="color:#99c794;">Second </span><span style="color:#99c794;">Way</span><span style="color:#99c794;">		</span><span style="color:#99c794;">-----------------------#</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>longest<span style="color:#f97b58;">-</span>chain '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span>    <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span>   <span style="color:#f9ae58;">25</span> <span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">34</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>					    <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span><span style="color:#5fb4b4;">)</span><br><br>I need a <span style="color:#6699cc;font-style:italic;">list</span> like :  <span style="color:#5fb4b4;">(</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span><span style="color:#5fb4b4;">)</span>      <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span><span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">25</span><span style="color:#5fb4b4;">)</span>      <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">34</span><span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">func45</span> <span style="color:#5fb4b4;">(</span>lst temp storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>		 							storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>							<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">&lt;=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cadr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 					<span style="color:#5fb4b4;">(</span>func45 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> temp<span style="color:#5fb4b4;">)</span>   storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 											<span style="color:#5fb4b4;">(</span>func45 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> temp<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">find_lengths</span>  <span style="color:#5fb4b4;">(</span>lst storage<span style="color:#5fb4b4;">)</span>					<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">this </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">1)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span> 					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 							<span style="color:#5fb4b4;">(</span>find_lengths <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> storage <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>'<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span>    <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span>   <span style="color:#f9ae58;">25</span> <span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">34</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">func45-2</span> <span style="color:#5fb4b4;">(</span>lst counter<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span><span style="color:#f97b58;">*</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>lst1 							<span style="color:#5fb4b4;">(</span>func45 lst <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">14)      </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">27)     </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">25)      </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">12 </span><span style="color:#a6acb9;">19 </span><span style="color:#a6acb9;">34)     </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1) </span><span style="color:#a6acb9;">)</span><br>			  <span style="color:#5fb4b4;">(</span>lst2 							<span style="color:#5fb4b4;">(</span>find_lengths  lst1 <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>	<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(   </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">			</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">			</span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">			</span><span style="color:#a6acb9;">  </span><span style="color:#a6acb9;">1)</span><br>			  <span style="color:#5fb4b4;">(</span>max_ 							<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">apply</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#f97b58;">max</span> lst2<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;">  </span><span style="color:#a6acb9;">3</span><br>			<span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> counter lst2<span style="color:#5fb4b4;">)</span> max_<span style="color:#5fb4b4;">)</span>  <br>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> counter lst1<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span>func45<span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span>  lst <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>func45<span style="color:#f97b58;">-</span><span style="color:#f9ae58;">2</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span>    <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span>   <span style="color:#f9ae58;">25</span> <span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">34</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span><span style="color:#5fb4b4;">)</span><br><br><br>Line <span style="color:#f9ae58;">1994</span> ! Force it !  <br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Make </span><span style="color:#99c794;">it </span><span style="color:#99c794;">unique</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span>		<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>	<span style="color:#5fb4b4;">uniq</span>	<span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span>		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">a      </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> lst <br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">member</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span>uniq <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span>uniq <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>			<span style="color:#ec5f66;font-style:italic;">nil</span> <br><br>		<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> 	<span style="color:#5fb4b4;">uniq2</span> 	<span style="color:#5fb4b4;">(</span>lst 	&amp;optional <span style="color:#5fb4b4;">(</span>acc <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">a      </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">)     </span><span style="color:#a6acb9;">acc </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">nil</span><br><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	lst <br>			<span style="color:#5fb4b4;">(</span>uniq2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">member</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> acc<span style="color:#5fb4b4;">)</span><br>									acc<br>									<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> acc <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>			acc<br>	<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br>		<br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.46*</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>A maximal chain m in a sequence of integers I is a chain defined in the sense of<br>Exercise <span style="color:#f9ae58;">4.45</span>, such that there is no chain k in I such that m is a subsequence of k.<br>Define a procedure which takes a sequence of integers <span style="color:#f97b58;">and</span> returns the maximal<br>chain <span style="color:#c695c6;">with</span> the largest <span style="color:#6699cc;font-style:italic;">sum</span>. <span style="color:#c695c6;">If</span> you detect maximal chains <span style="color:#c695c6;">with</span> <span style="color:#f97b58;">equal</span> sums, <span style="color:#c695c6;">return</span><br>the one you encountered <span style="color:#6699cc;font-style:italic;">first</span>.<br><br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>longest<span style="color:#f97b58;">-</span>chain '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span>    <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span>   <span style="color:#f9ae58;">25</span> <span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">34</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>					    <br><br>I need a <span style="color:#6699cc;font-style:italic;">list</span> like :  <span style="color:#5fb4b4;">(</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span><span style="color:#5fb4b4;">)</span>      <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span><span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">25</span><span style="color:#5fb4b4;">)</span>      <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">34</span><span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>I need a <span style="color:#6699cc;font-style:italic;">list</span> like :  <span style="color:#5fb4b4;">(</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span><span style="color:#5fb4b4;">)</span>        <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">38</span><span style="color:#5fb4b4;">)</span>      <span style="color:#5fb4b4;">(</span> <span style="color:#f9ae58;">25</span><span style="color:#5fb4b4;">)</span>        <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">65</span><span style="color:#5fb4b4;">)</span>         <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">give_first</span>  <span style="color:#5fb4b4;">(</span> x  storage<span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span>								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">&lt;=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> 			<span style="color:#5fb4b4;">(</span>give_first <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>										<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br>	<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">give_first </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14   </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6   </span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">7) </span><span style="color:#a6acb9;">nil)</span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return </span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14)</span><br><br><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>	<span style="color:#5fb4b4;">give_first_sum</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span><br>				<span style="color:#f9ae58;">0</span><br>				<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span>give_first_sum <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br>	<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">give_first_sum </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">give_first </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14 </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6) </span><span style="color:#a6acb9;">nil) </span><span style="color:#a6acb9;">)    </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return     </span><span style="color:#a6acb9;">39</span><br><br><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">give_remain</span>  <span style="color:#5fb4b4;">(</span>g_f  x <span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> g_f<span style="color:#5fb4b4;">)</span>			x<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> g_f<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span>give_remain <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> g_f<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>										<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">ERROR </span><span style="color:#99c794;">! </span><span style="color:#99c794;">Two </span><span style="color:#99c794;">lists </span><span style="color:#99c794;">are </span><span style="color:#99c794;">different!</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">give_remain </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14 </span><span style="color:#a6acb9;">) </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14   </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6 </span><span style="color:#a6acb9;">9   </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">7) </span><span style="color:#a6acb9;">)</span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return</span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6 </span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">7)</span><br><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">main</span>  <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span><span style="color:#f97b58;">*</span>	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span> first_ 					<span style="color:#5fb4b4;">(</span>give_first   x   <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14)</span><span style="color:#a6acb9;">							</span><br>			<span style="color:#5fb4b4;">(</span> first_sum					<span style="color:#5fb4b4;">(</span>give_first_sum   first_<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>			<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">39</span><br>			<span style="color:#5fb4b4;">(</span> remain_					<span style="color:#5fb4b4;">(</span>give_remain      first_  x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6 </span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">7)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> remain_<span style="color:#5fb4b4;">)</span>										<br>					first_sum<br>					<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">max</span>   first_sum   <span style="color:#5fb4b4;">(</span>main remain_<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span>	<br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br>	<br><br><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">main  </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14   </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6 </span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">10 </span><span style="color:#a6acb9;">11   </span><span style="color:#a6acb9;">0 </span><span style="color:#a6acb9;">177    </span><span style="color:#a6acb9;">50 </span><span style="color:#a6acb9;">50 </span><span style="color:#a6acb9;">50 </span><span style="color:#a6acb9;">50   </span><span style="color:#a6acb9;">)) </span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return </span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">  </span><span style="color:#a6acb9;">200</span><br><br><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">#----------------------</span><span style="color:#99c794;">		</span><span style="color:#99c794;">Second </span><span style="color:#99c794;">Way</span><span style="color:#99c794;">		</span><span style="color:#99c794;">-----------------------#</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br><br><span style="color:#f97b58;">*</span> <span style="color:#5fb4b4;">(</span>longest<span style="color:#f97b58;">-</span>chain '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span>    <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span>   <span style="color:#f9ae58;">25</span> <span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">34</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br><br>I need a <span style="color:#6699cc;font-style:italic;">list</span> like :  <span style="color:#5fb4b4;">(</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span><span style="color:#5fb4b4;">)</span>      <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span> <span style="color:#f9ae58;">27</span><span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">25</span><span style="color:#5fb4b4;">)</span>      <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">12</span> <span style="color:#f9ae58;">19</span> <span style="color:#f9ae58;">34</span><span style="color:#5fb4b4;">)</span>     <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">func45</span> <span style="color:#5fb4b4;">(</span>lst temp storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>		 							storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>							<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">&lt;=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cadr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 					<span style="color:#5fb4b4;">(</span>func45 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> temp<span style="color:#5fb4b4;">)</span>   storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 											<span style="color:#5fb4b4;">(</span>func45 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>  storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> temp<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>I need a <span style="color:#6699cc;font-style:italic;">list</span> like :  <span style="color:#5fb4b4;">(</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">14</span><span style="color:#5fb4b4;">)</span>        <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">38</span><span style="color:#5fb4b4;">)</span>      <span style="color:#5fb4b4;">(</span> <span style="color:#f9ae58;">25</span><span style="color:#5fb4b4;">)</span>        <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">65</span><span style="color:#5fb4b4;">)</span>         <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">find_sums</span>  <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span><br>			<span style="color:#f9ae58;">0</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>find_sums <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">find_biggest</span>   <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span> <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span><br>			<span style="color:#f9ae58;">0</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">max</span>  <span style="color:#5fb4b4;">(</span>find_sums <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span>find_biggest <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">main</span>  <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span>find_biggest <span style="color:#5fb4b4;">(</span>func45 lst <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.47</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>Define a procedure which takes a sequence of integers <span style="color:#f97b58;">and</span> returns the chain – <span style="color:#f97b58;">not</span><br>necessarily maximal – <span style="color:#c695c6;">with</span> the largest <span style="color:#6699cc;font-style:italic;">sum</span>. <span style="color:#c695c6;">If</span> you detect maximal chains <span style="color:#c695c6;">with</span><br><span style="color:#f97b58;">equal</span> sums, <span style="color:#c695c6;">return</span> the one you encountered <span style="color:#6699cc;font-style:italic;">first</span>.<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">give_first</span>  <span style="color:#5fb4b4;">(</span> x  storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span>								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">&lt;=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> 			<span style="color:#5fb4b4;">(</span>give_first <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>										<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">give_first </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14   </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6   </span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">7) </span><span style="color:#a6acb9;">nil)</span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return </span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14)</span><br><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>	<span style="color:#5fb4b4;">give_first_sum</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span><br>			<span style="color:#f9ae58;">0</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span>give_first_sum <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">give_first_sum </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">give_first </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14 </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6) </span><span style="color:#a6acb9;">nil) </span><span style="color:#a6acb9;">)    </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return     </span><span style="color:#a6acb9;">39</span><br><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">give_remain</span>  <span style="color:#5fb4b4;">(</span>g_f  x <span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> g_f<span style="color:#5fb4b4;">)</span>			x<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> g_f<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span>give_remain <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> g_f<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>										<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">print</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">ERROR </span><span style="color:#99c794;">! </span><span style="color:#99c794;">Two </span><span style="color:#99c794;">lists </span><span style="color:#99c794;">are </span><span style="color:#99c794;">different!</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">give_remain </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14 </span><span style="color:#a6acb9;">) </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14   </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6 </span><span style="color:#a6acb9;">9   </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">7) </span><span style="color:#a6acb9;">)</span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return</span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6 </span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">7)</span><br><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">main_</span>  <span style="color:#5fb4b4;">(</span>x   sum_   storage<span style="color:#5fb4b4;">)</span> <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span><span style="color:#f97b58;">*</span>	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span> first_ 					<span style="color:#5fb4b4;">(</span>give_first   x   <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>				<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14)</span><span style="color:#a6acb9;">							</span><br>			<span style="color:#5fb4b4;">(</span> first_sum					<span style="color:#5fb4b4;">(</span>give_first_sum   first_<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>			<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">39</span><br>			<span style="color:#5fb4b4;">(</span> remain_					<span style="color:#5fb4b4;">(</span>give_remain      first_  x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>		<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6 </span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">8 </span><span style="color:#a6acb9;">7)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> remain_<span style="color:#5fb4b4;">)</span>										<br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">&lt;</span> first_sum   sum_<span style="color:#5fb4b4;">)</span><br>							storage<br>							first_<br>					<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span>main_  remain_  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">max</span> sum_ first_sum<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">&lt;</span> first_sum   sum_<span style="color:#5fb4b4;">)</span><br>																storage<br>																first_<br>																	<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>				<br>	<span style="color:#5fb4b4;">)</span>	<br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">main</span> 	<span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span>main_  x  <span style="color:#f9ae58;">0</span>   <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">)</span><br>	<br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">main  </span><span style="color:#a6acb9;">'(12 </span><span style="color:#a6acb9;">13 </span><span style="color:#a6acb9;">14   </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">4 </span><span style="color:#a6acb9;">5 </span><span style="color:#a6acb9;">6 </span><span style="color:#a6acb9;">9 </span><span style="color:#a6acb9;">10 </span><span style="color:#a6acb9;">11   </span><span style="color:#a6acb9;">0 </span><span style="color:#a6acb9;">177    </span><span style="color:#a6acb9;">50 </span><span style="color:#a6acb9;">50 </span><span style="color:#a6acb9;">50 </span><span style="color:#a6acb9;">50   </span><span style="color:#a6acb9;">))    </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return   </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">50 </span><span style="color:#a6acb9;">50 </span><span style="color:#a6acb9;">50 </span><span style="color:#a6acb9;">50)</span><br><br><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">-------------------</span><span style="color:#99c794;">					</span><span style="color:#99c794;">Exercise </span><span style="color:#99c794;">4.48</span><span style="color:#99c794;">					</span><span style="color:#99c794;">-------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#99c794;">----------------------------------------------------------------------------------------</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><span style="color:#5fb4b4;">"</span><br><br>See the PAIRLISTS in lecture notes. Define a procedure that “pairs” an arbitrary<br>number of lists. Here is a sample interaction:<br><br>pairlist '<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#f97b58;">=</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f97b58;">-</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">pairlist</span>  <span style="color:#5fb4b4;">(</span>x   list1  list2<span style="color:#5fb4b4;">)</span><br><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span> 					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> list1<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> list2<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>							<span style="color:#5fb4b4;">(</span>pairlist  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">caar</span> x<span style="color:#5fb4b4;">)</span> list1<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cadar</span> x<span style="color:#5fb4b4;">)</span> list2<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">pairlist </span><span style="color:#a6acb9;">'( </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">b) </span><span style="color:#a6acb9;">(= </span><span style="color:#a6acb9;">=) </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2) </span><span style="color:#a6acb9;">(+ </span><span style="color:#a6acb9;">-) </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">9) </span><span style="color:#a6acb9;">)  </span><span style="color:#a6acb9;">nil </span><span style="color:#a6acb9;">nil) </span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return </span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">((A </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">+ </span><span style="color:#a6acb9;">3) </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">- </span><span style="color:#a6acb9;">9))</span><br><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">pairlist2</span>  <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#6699cc;font-style:italic;">cadr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<br><span style="color:#5fb4b4;">)</span><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.49					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>Define a procedure SEARCH-POS that takes a list as search item, another list as <br>a search list and returns the list of positions that the search item is found in the<br>search list. Positioning starts with 0. A sample interaction:<br><br>* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">search</span><span style="color:#f97b58;">-</span>pos '<span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span>a b c <span style="color:#c695c6;">d</span> a b a b<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">6</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br><br>* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">search</span><span style="color:#f97b58;">-</span>pos '<span style="color:#5fb4b4;">(</span>a a<span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span>a a a a b a b<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<br>						<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">get_first_n_elm</span>   <span style="color:#5fb4b4;">(</span>x   n  storage<span style="color:#5fb4b4;">)</span>                 <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">n   </span><span style="color:#a6acb9;">=   </span><span style="color:#a6acb9;">index </span><span style="color:#a6acb9;">+ </span><span style="color:#a6acb9;">1</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> n <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span>get_first_n_elm  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> n <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br>	<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">get_first_n_elm </span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">e </span><span style="color:#a6acb9;">f </span><span style="color:#a6acb9;">g </span><span style="color:#a6acb9;">h </span><span style="color:#a6acb9;">)  </span><span style="color:#a6acb9;">5  </span><span style="color:#a6acb9;">nil)   </span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give    </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">D </span><span style="color:#a6acb9;">E) </span><br><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> 	<span style="color:#5fb4b4;">search_pos_</span>    <span style="color:#5fb4b4;">(</span>x  y  index_storage  index<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> y<span style="color:#5fb4b4;">)</span> 														index_storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> x  <span style="color:#5fb4b4;">(</span>get_first_n_elm y  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 				<span style="color:#5fb4b4;">(</span>search_pos_ x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> index index_storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> index <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 															<span style="color:#5fb4b4;">(</span>search_pos_ x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> y<span style="color:#5fb4b4;">)</span>  index_storage  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> index <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>   <span style="color:#5fb4b4;">search_pos</span>   <span style="color:#5fb4b4;">(</span>x  y<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span>search_pos_ x y <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.50					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>Define a procedure LAST2 that takes a list and returns the last element of the list.<br>Of course, don’t use LAST. One way could be to keep a counter, so that you can<br>compare this to the length of the list to recognize whether you are close enough to<br>the end of the list.<br><br><span style="color:#5fb4b4;">(</span>a b c <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span> <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> 		<span style="color:#5fb4b4;">last2</span> 	<span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 								<span style="color:#5fb4b4;">(</span>last2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">last3</span>  <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""#----------------------		Third Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">last4</span>  <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> lst<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.51					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>Define an iterative procedure CHOP-LAST, which removes the final element of the<br>given list – its like CDR from the back. You are NOT allowed to make<br><span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">REVERSE</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">CDR</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">REVERSE</span> LST<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>. Nothing to be done for an empty list, just<br>return it as it is<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">but </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">single </span><span style="color:#a6acb9;">element </span><span style="color:#a6acb9;">list </span><span style="color:#a6acb9;">gets </span><span style="color:#a6acb9;">“nilled”.</span><br><br><span style="color:#5fb4b4;">(</span>a b c <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span>   ->    <span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">chop_last</span> 	<span style="color:#5fb4b4;">(</span>x   storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span>								<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 									<span style="color:#5fb4b4;">(</span>chop_last <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.52					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Define a procedure that checks whether a given list of symbols is a palindrome.<br>Use CAR and your solution to Ex. 4.21.<br><br><span style="color:#5fb4b4;">(</span>ey edip ada n ada pide ye<span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">last1</span>  <span style="color:#5fb4b4;">(</span>x    last_element<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span><br>		last_element<br>		<span style="color:#5fb4b4;">(</span>last1  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">last1 </span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">) </span><span style="color:#a6acb9;">nil)</span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give </span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">D</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">chop_last</span> 	<span style="color:#5fb4b4;">(</span>x   storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span>								<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 									<span style="color:#5fb4b4;">(</span>chop_last <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">chop_last </span><span style="color:#a6acb9;">'(a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">c </span><span style="color:#a6acb9;">d </span><span style="color:#a6acb9;">x) </span><span style="color:#a6acb9;">nil)  </span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">give </span><span style="color:#a6acb9;">		</span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">A </span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">C </span><span style="color:#a6acb9;">D)</span><br><br><br>* <span style="color:#5fb4b4;">(</span>palindrome '<span style="color:#5fb4b4;">(</span>a b b c b b a<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> 	<span style="color:#5fb4b4;">palindrome</span> 	<span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span>			<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">b </span><span style="color:#a6acb9;">a)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span> 										<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span>last1 x <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   				<span style="color:#5fb4b4;">(</span>palindrome <span style="color:#5fb4b4;">(</span>chop_last <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">send </span><span style="color:#a6acb9;">without </span><span style="color:#a6acb9;">car </span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 											<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> 	<span style="color:#5fb4b4;">palindrome2</span> 	<span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span>			<br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> lst<span style="color:#5fb4b4;">)</span> 										<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 			<span style="color:#5fb4b4;">(</span>palindrome2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 												<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""#----------------------		Third Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">t</span> <span style="color:#ec5f66;font-style:italic;">t</span> <span style="color:#ec5f66;font-style:italic;">t</span> <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">helper</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span><br>			<span style="color:#ec5f66;font-style:italic;">t</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>helper <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">palindrome3</span>  <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br><br>	<span style="color:#5fb4b4;">(</span>helper <br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> a b<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>		lst <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> lst<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.53					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Define your own version of NTH <span style="color:#5fb4b4;">(</span>don’<span style="color:#ec5f66;font-style:italic;">t</span> use <span style="color:#6699cc;font-style:italic;">NTHCDR</span><span style="color:#5fb4b4;">)</span>.<br><br>   <span style="color:#5fb4b4;">(</span>a b X <span style="color:#c695c6;">d</span> e <span style="color:#6699cc;font-style:italic;">f</span> <span style="color:#5fb4b4;">)</span>   2.th  X <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">n_th</span>  <span style="color:#5fb4b4;">(</span> x  n index<span style="color:#5fb4b4;">)</span>     <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span> 						<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> n index<span style="color:#5fb4b4;">)</span> 					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 							<span style="color:#5fb4b4;">(</span>n_th <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span> n <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> index <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br>  <span style="color:#5fb4b4;">(</span>a b X <span style="color:#c695c6;">d</span> e <span style="color:#6699cc;font-style:italic;">f</span> <span style="color:#5fb4b4;">)</span>   2.th  X <br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">n_th_2</span>  <span style="color:#5fb4b4;">(</span>lst n<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>result 		<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>			 <span style="color:#5fb4b4;">(</span>counter 		<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dolist</span> <span style="color:#5fb4b4;">(</span>i lst result<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> counter n<span style="color:#5fb4b4;">)</span><br>				 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result i<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> counter <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				 	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> counter <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.54					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>Define a procedure UNIQ that takes a list and removes all the repeated elements in<br>the list "keeping only the first" occurrence. For instance:<br><br>* <span style="color:#5fb4b4;">(</span>uniq '<span style="color:#5fb4b4;">(</span>a b r a c a <span style="color:#c695c6;">d</span> a b r a<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span>A B R C <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">unique-list</span>  <span style="color:#5fb4b4;">(</span>x  storage  reader<span style="color:#5fb4b4;">)</span>	<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">initially  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">storage </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">nil) </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">reader </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">car </span><span style="color:#a6acb9;">x) </span><span style="color:#a6acb9;">) </span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> x<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span>  reader<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span> <br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span>  reader <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>unique<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">list</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  storage  reader<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>unique<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">list</span>  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span>  reader<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">unique_list</span>  <span style="color:#5fb4b4;">(</span>lst storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>  								storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">member</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 				<span style="color:#5fb4b4;">(</span>unique_list <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 										<span style="color:#5fb4b4;">(</span>unique_list <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">main</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span>unique_list  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.55					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Solve Ex 4.54 by "keeping the last" occurrence rather than the first.<br><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">unique_list_2</span>  <span style="color:#5fb4b4;">(</span>lst storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>  								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">member</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 				<span style="color:#5fb4b4;">(</span>unique_list_2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 										<span style="color:#5fb4b4;">(</span>unique_list_2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.56					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Define a procedure REMLAST which removes the last occurrence of "an item" from a<br>list. Do not use MEMBER or REVERSE.<br><br>'x   '<span style="color:#5fb4b4;">(</span>a b c x x <span style="color:#c695c6;">d</span> x X c <span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">count_them</span> <span style="color:#5fb4b4;">(</span>x lst counter<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>				 counter<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span>		<span style="color:#5fb4b4;">(</span>count_them  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 						<span style="color:#5fb4b4;">(</span>count_them  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span>    counter<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>'x   '<span style="color:#5fb4b4;">(</span>a b c x x <span style="color:#c695c6;">d</span> x X c <span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">remlast</span> <span style="color:#5fb4b4;">(</span>x lst storage counter count_X<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>														storage<span style="color:#5fb4b4;">)</span>								<br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> counter count_X<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 				<span style="color:#5fb4b4;">(</span>remlast x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> count_X<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span> 												<span style="color:#5fb4b4;">(</span>remlast x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> count_X<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 																<span style="color:#5fb4b4;">(</span>remlast x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> counter count_X<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">main</span> <span style="color:#5fb4b4;">(</span>x lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>count_X 					<span style="color:#5fb4b4;">(</span>count_them x lst <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span>remlast x lst <span style="color:#ec5f66;font-style:italic;">nil</span> <span style="color:#f9ae58;">0</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> count_X <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.57					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Define a procedure FINDLAST which returns the index of the last occurrence of an<br>item in a list. Do not use MEMBER or REVERSE.<br><br><br>'x   '<span style="color:#5fb4b4;">(</span>a b c x x <span style="color:#c695c6;">d</span> x X c <span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">count_them</span> <span style="color:#5fb4b4;">(</span>x lst counter<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>				 counter<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span>		<span style="color:#5fb4b4;">(</span>count_them  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 						<span style="color:#5fb4b4;">(</span>count_them  x  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span>    counter<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>'x   '<span style="color:#5fb4b4;">(</span>a b c x x <span style="color:#c695c6;">d</span> x X c <span style="color:#5fb4b4;">)</span> <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">findlast</span> <span style="color:#5fb4b4;">(</span>x lst counterforX count_X   indx<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>														indx<span style="color:#5fb4b4;">)</span>								<br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> counterforX count_X<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 			indx<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span> 												<span style="color:#5fb4b4;">(</span>findlast x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counterforX <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> count_X <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> indx <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 																<span style="color:#5fb4b4;">(</span>findlast x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span>  counterforX  count_X  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> indx <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">main</span> <span style="color:#5fb4b4;">(</span>x lst<span style="color:#5fb4b4;">)</span><br><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>count_X 					<span style="color:#5fb4b4;">(</span>count_them x lst <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span>findlast x lst  <span style="color:#f9ae58;">0</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> count_X <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br>'x   '<span style="color:#5fb4b4;">(</span>a b c x x <span style="color:#c695c6;">d</span> x X c <span style="color:#5fb4b4;">)</span> <br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">findlast2</span> <span style="color:#5fb4b4;">(</span>x lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>result 		<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dotimes</span>  <span style="color:#5fb4b4;">(</span>i <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> result<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result i<span style="color:#5fb4b4;">)</span><br>					<span style="color:#ec5f66;font-style:italic;">nil</span><br>			<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.58					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>Define a procedure REMOVEX that takes an element and a list<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">returns </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">list </span><span style="color:#a6acb9;">where</span><br>all the occurrences of the element that are preceded by the symbol X are removed<br>from the list.<br><br><br>'x   '<span style="color:#5fb4b4;">(</span> a b c X v X c X <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span>  	->		  '<span style="color:#5fb4b4;">(</span> a b c x  _  x _ x _<span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">removex</span> <span style="color:#5fb4b4;">(</span>x lst storage<span style="color:#5fb4b4;">)</span><br><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span> 						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span>removex x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cddr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 								<span style="color:#5fb4b4;">(</span>removex x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.59					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Define a function ROTATE-LEFT that takes a list and moves the first element to<br>the end of the list. For instance, <span style="color:#5fb4b4;">(</span>ROTATE<span style="color:#f97b58;">-</span>LEFT '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> should give <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>,<br><span style="color:#5fb4b4;">(</span>ROTATE<span style="color:#f97b58;">-</span>LEFT '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> should give <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>, etc. Apart from DEFUN, you are al-<br>lowed to use LET, LIST, APPEND, CAR, DOLIST, SETF and IF. No other function is<br>available for use.<br><br><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span> 	->		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">ROTATE-LEFT</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">)</span><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span> 	->	 new_set :	<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>		->		<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>	<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">ROTATE-LEFT2</span>  <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>one  				<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>			 <span style="color:#5fb4b4;">(</span>result  			<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>			 <span style="color:#5fb4b4;">(</span>new_set 			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> lst <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dolist</span> 	<span style="color:#5fb4b4;">(</span>i lst result<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> one <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span>  result  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> result <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> i<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> one <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.60					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Substitute : a function with 3 arguments: old, new, and exp, <br><br><span style="color:#5fb4b4;">(</span>subs 'x 'k '<span style="color:#5fb4b4;">(</span>x <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span> z<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   -> 	<span style="color:#5fb4b4;">(</span>k <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span> z<span style="color:#5fb4b4;">)</span> <br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">subs</span> <span style="color:#5fb4b4;">(</span>lst old new storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span> 							<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> old<span style="color:#5fb4b4;">)</span> 				<span style="color:#5fb4b4;">(</span>subs <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> old new <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> new storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 									<span style="color:#5fb4b4;">(</span>subs <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> old new <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">subs2</span> <span style="color:#5fb4b4;">(</span>lst old new<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> x old<span style="color:#5fb4b4;">)</span><br>								new<br>								x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	lst<span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">)</span><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.61					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Define a procedure MATCHES that takes two lists, a pattern and a text, and re- <br>turns the count of the occurrences of the pattern in the text. You need to be <br>careful about overlapping matches. For instance, <span style="color:#5fb4b4;">(</span>A C A<span style="color:#5fb4b4;">)</span> has 3 occurrences in<br><span style="color:#5fb4b4;">(</span>A C A C A <span style="color:#ec5f66;font-style:italic;">T</span> G C A C A <span style="color:#ec5f66;font-style:italic;">T</span> G C<span style="color:#5fb4b4;">)</span>. You are not allowed to use procedures like<br>SUBSEQ to take portions of the text for comparison<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">your </span><span style="color:#a6acb9;">solution </span><span style="color:#a6acb9;">must </span><span style="color:#a6acb9;">go </span><span style="color:#a6acb9;">through</span><br>the text element by element.<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> 	<span style="color:#5fb4b4;">matches_</span> <span style="color:#5fb4b4;">(</span>text lst result<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> 		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dotimes</span> <span style="color:#5fb4b4;">(</span>i <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> result<span style="color:#5fb4b4;">)</span><br><br>								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i text<span style="color:#5fb4b4;">)</span> result<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>				 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#f9ae58;">1</span><br>				<span style="color:#f9ae58;">0</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br>  <br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">matches</span> <span style="color:#5fb4b4;">(</span>text lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> text<span style="color:#5fb4b4;">)</span><br>			<span style="color:#f9ae58;">0</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#5fb4b4;">(</span>matches_ text lst <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>matches <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> text<span style="color:#5fb4b4;">)</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.62					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Define a procedure SHUFFLE that takes a list and returns a random permutation of<br>the list. A random permutation of a list is one of all the possible orderings of the<br>elements of the list. You can follow any strategy you like – recursive or iterative.<br>You might find two built-ins especially useful: RANDOM takes an integer and gives a<br>random number from 0 to one less than the given integer<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">NTH </span><span style="color:#a6acb9;">takes </span><span style="color:#a6acb9;">an </span><span style="color:#a6acb9;">integer </span><span style="color:#a6acb9;">and</span><br>a list, returning the element at the position of the given integer – remember that<br>positions are counted starting from 0.<br><br><br>'<span style="color:#5fb4b4;">(</span>a b c <span style="color:#c695c6;">d</span> e<span style="color:#5fb4b4;">)</span>  		-> 			'<span style="color:#5fb4b4;">(</span>a c e <span style="color:#c695c6;">d</span> b<span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span>		->			 <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span>         <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">random</span> <span style="color:#6699cc;font-style:italic;">length</span>:<span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span>    :   0-5<br><br>I need a func like: 	<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#5fb4b4;">"</span><span style="color:#99c794;">3</span><span style="color:#5fb4b4;">"</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span>		->			 <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> _ <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span><br><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">shuffle_</span> <span style="color:#5fb4b4;">(</span>lst x storage<span style="color:#5fb4b4;">)</span> <br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>  					storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 			<span style="color:#5fb4b4;">(</span>shuffle_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> x storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 							<span style="color:#5fb4b4;">(</span>shuffle_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">shuffle</span> <span style="color:#5fb4b4;">(</span>lst storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span><span style="color:#f97b58;">*</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>rnd 						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">random</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			 <span style="color:#5fb4b4;">(</span>x  						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> rnd lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			 <span style="color:#5fb4b4;">(</span>remain  					<span style="color:#5fb4b4;">(</span>shuffle_ lst x <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span> 							storage<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> x storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 									<span style="color:#5fb4b4;">(</span>shuffle  remain  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span>  x   storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.63					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Modify SUBSTITUTE to D-SUBS <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">for</span> “deep <span style="color:#6699cc;font-style:italic;">substitute</span>”<span style="color:#5fb4b4;">)</span>, so that it does the replace-<br>ment for all occurrences of old, no matter how deeply embedded.<br><br>Substitute : a function with 3 arguments: old, new, and exp, <br><br><span style="color:#5fb4b4;">(</span>subs 'x 'k         '<span style="color:#5fb4b4;">(</span>x <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span> z<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   	-> 		<span style="color:#5fb4b4;">(</span>K <span style="color:#5fb4b4;">(</span>K y<span style="color:#5fb4b4;">)</span> z<span style="color:#5fb4b4;">)</span> <br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">subs3</span> <span style="color:#5fb4b4;">(</span>lst old new<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> x<span style="color:#5fb4b4;">)</span><br>									<span style="color:#5fb4b4;">(</span>subs3 x old new<span style="color:#5fb4b4;">)</span><br>									<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> x old<span style="color:#5fb4b4;">)</span><br>											new<br>											x<br>									<span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>	lst<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span>subs 'x 'k         '<span style="color:#5fb4b4;">(</span>x <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span> z<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   	-> 		<span style="color:#5fb4b4;">(</span>K <span style="color:#5fb4b4;">(</span>K y<span style="color:#5fb4b4;">)</span> z<span style="color:#5fb4b4;">)</span> <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">subs4</span> <span style="color:#5fb4b4;">(</span>lst old new storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span> 							<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 					<span style="color:#5fb4b4;">(</span>subs4 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> old new <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span>subs4 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> old new <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> old<span style="color:#5fb4b4;">)</span> 				<span style="color:#5fb4b4;">(</span>subs4 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> old new <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> new storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 									<span style="color:#5fb4b4;">(</span>subs4 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> old new <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span>K <span style="color:#5fb4b4;">(</span>K Y<span style="color:#5fb4b4;">)</span> Z<span style="color:#5fb4b4;">)</span><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.64					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Define a recursive procedure that counts the non-nil atoms in a list. For instance,<br>an input like <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span> c<span style="color:#5fb4b4;">)</span> should return 3, <span style="color:#5fb4b4;">(</span>a <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>b <span style="color:#5fb4b4;">(</span>c<span style="color:#5fb4b4;">)</span> <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> should return 4, and<br>so on. Remember that the built-in ATOM returns NIL for all lists except NIL<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">NULL</span><br>returns T only for NIL<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">ENDP </span><span style="color:#a6acb9;">is </span><span style="color:#a6acb9;">like </span><span style="color:#a6acb9;">NULL, </span><span style="color:#a6acb9;">except </span><span style="color:#a6acb9;">that </span><span style="color:#a6acb9;">it </span><span style="color:#a6acb9;">gives </span><span style="color:#a6acb9;">an </span><span style="color:#a6acb9;">error </span><span style="color:#a6acb9;">if </span><span style="color:#a6acb9;">its </span><span style="color:#a6acb9;">input</span><br>happens to be something other than a list. Your function should use<br> a counter/accumulator – it will be a two argument function.<br><br><br><span style="color:#5fb4b4;">(</span>a <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>b <span style="color:#5fb4b4;">(</span>c<span style="color:#5fb4b4;">)</span> <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>			 should return 		4<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">counter</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span><br>			<span style="color:#f9ae58;">0</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span>  <span style="color:#f9ae58;">1</span>  <span style="color:#5fb4b4;">(</span>counter <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">counter2</span> <span style="color:#5fb4b4;">(</span>lst counter<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span><br>			counter<br>			<span style="color:#5fb4b4;">(</span>counter2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.65					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>Define a procedure BRING-TO-FRONT <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">or</span> BFT <span style="color:#c695c6;">for</span> short<span style="color:#5fb4b4;">)</span>, that takes an item and a<br>list and returns a version where all the occurrences of the item in the given list are<br>brought to the front of the list.<br><br>For instance, <span style="color:#5fb4b4;">(</span>bring<span style="color:#f97b58;">-</span><span style="color:#c695c6;">to</span><span style="color:#f97b58;">-</span>front 'a '<span style="color:#5fb4b4;">(</span>a b r a c a <span style="color:#c695c6;">d</span> a b r a<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> would return<br><br>								<span style="color:#5fb4b4;">(</span>A A A A A B R C <span style="color:#c695c6;">D</span> B R<span style="color:#5fb4b4;">)</span><span style="color:#a6acb9;">;</span><br><br>and <span style="color:#5fb4b4;">(</span>bring<span style="color:#f97b58;">-</span><span style="color:#c695c6;">to</span><span style="color:#f97b58;">-</span>front 'b '<span style="color:#5fb4b4;">(</span>a b r a c a <span style="color:#c695c6;">d</span> a b r a<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> would return<br><br>						<span style="color:#5fb4b4;">(</span>B B A R A C A <span style="color:#c695c6;">D</span> A R A<span style="color:#5fb4b4;">)</span>.<br><br>You are NOT allowed to count the occurrences of the item in the given list or use REMOVE.<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">bft</span> <span style="color:#5fb4b4;">(</span>x lst temp storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span>  							<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> temp <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span> 					<span style="color:#5fb4b4;">(</span>bft x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> x temp<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 									<span style="color:#5fb4b4;">(</span>bft x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> temp <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br>Force it ! You are going to change the world !<br>This is your fate !<br>Remember your f*cking past man ! Remember your past! This is determinism.<br>You have to change the world.<br>Nothing can stop you. Nothing...<br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.66					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Define a procedure that groups the elements in a list putting consecutive occur-<br>rences of items in lists. For instance, <br><br><span style="color:#5fb4b4;">(</span>group '<span style="color:#5fb4b4;">(</span>a a b c c c <span style="color:#c695c6;">d</span> <span style="color:#c695c6;">d</span> e<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> should give<br>	<br>		 <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A A<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>B<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>C C C<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">D</span> <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>E<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>. <br><br>	 Note that you should NOT bring together non-consecutive repetitions<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">call </span><span style="color:#a6acb9;">like </span><br><br><span style="color:#5fb4b4;">(</span>group '<span style="color:#5fb4b4;">(</span>a b b c b b c<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> should return <br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>B B<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>C<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>B B<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>C<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>.<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">group</span> <span style="color:#5fb4b4;">(</span>lst reader temp storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span> 								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> temp<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> reader<span style="color:#5fb4b4;">)</span> 					<span style="color:#5fb4b4;">(</span>group <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> reader <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> reader temp<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 										<span style="color:#5fb4b4;">(</span>group lst <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span>  <span style="color:#ec5f66;font-style:italic;">nil</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> temp<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.67					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>Define a recursive procedure SUMMARIZE, that takes a list and returns a list of<br>pairs whose car is an element in the list and cadr is the number of times the el-<br>ement occurs in the list<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><br><br><span style="color:#5fb4b4;">(</span>summarize '<span style="color:#5fb4b4;">(</span>a b r a c a <span style="color:#c695c6;">d</span> a b r a<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> should give<br>			<br>			<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>a <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>b <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>r <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>c <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>.<br><br><br>I need   <span style="color:#5fb4b4;">(</span>a <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">summarize_</span> <span style="color:#5fb4b4;">(</span>lst cr counter<span style="color:#5fb4b4;">)</span><br><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span> 						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> cr <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> counter <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> cr <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 				<span style="color:#5fb4b4;">(</span>summarize_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> cr <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 								<span style="color:#5fb4b4;">(</span>summarize_ <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> cr counter<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>Now I need '<span style="color:#5fb4b4;">(</span>_ b r _ c _ <span style="color:#c695c6;">d</span> _ b r _<span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">remain</span> <span style="color:#5fb4b4;">(</span>lst x storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span> 					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> x<span style="color:#5fb4b4;">)</span> 			<span style="color:#5fb4b4;">(</span>remain <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> x storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 							<span style="color:#5fb4b4;">(</span>remain <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> x <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">summarize</span> <span style="color:#5fb4b4;">(</span>lst storage<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>remain 							<span style="color:#5fb4b4;">(</span>remain lst <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			  <span style="color:#5fb4b4;">(</span>first_ 							<span style="color:#5fb4b4;">(</span>summarize_ lst <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span> 						storage<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 								<span style="color:#5fb4b4;">(</span>summarize remain <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> storage <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> first_<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.68					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br><br>The Collatz sequence <span style="color:#5fb4b4;">(</span>see Exercise <span style="color:#f9ae58;">3.6</span><span style="color:#5fb4b4;">)</span> of a positive integer is the sequence starting<br>with the number itself and ending with 1, where the numbers in-between are the     <br>results of Collatz steps. For instance the Collatz sequence of 3 is 3 10 5 16 8 4 2 1. <br><br>Given a non-negative integer, compute the count of even and odd numbers in <br>its Collatz sequence. Return the result as a list of two numbers, the first is the even<br>count and the second is the odd count. <br><br>The solution for 3 will be <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span>.   <span style="color:#5fb4b4;">(</span>even, odd<span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">collatz</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br>		<br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>     	<span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">evenp</span> x<span style="color:#5fb4b4;">)</span>		<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">/</span> x <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">oddp</span>  x<span style="color:#5fb4b4;">)</span>		<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">*</span> <span style="color:#f9ae58;">3</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>3 	-> 		3 10 5 16 8 4 2 1 <br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">countEO</span> <span style="color:#5fb4b4;">(</span>x   &amp;key <span style="color:#5fb4b4;">(</span>even<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>odd<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br><br>		<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> even<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> odd<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">)</span><br><br>		<br>		<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">evenp</span> x<span style="color:#5fb4b4;">)</span>   <br>			<span style="color:#5fb4b4;">(</span>countEO  <span style="color:#5fb4b4;">(</span>collatz x<span style="color:#5fb4b4;">)</span>   :even<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> even<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>    :odd<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span>  odd<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">(</span>countEO  <span style="color:#5fb4b4;">(</span>collatz x<span style="color:#5fb4b4;">)</span>   :even<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> even<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span>          :odd<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> odd<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">count</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>		<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br>"""#----------------------		Second Way		-----------------------#"""<br><br>3 	-> 		3 10 5 16 8 4 2 1 <br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">countE</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#f9ae58;">0</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">or</span> <br>				<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">evenp</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">(</span>countE <span style="color:#5fb4b4;">(</span>collatz x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span>countE <span style="color:#5fb4b4;">(</span>collatz x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">countO</span> <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#f9ae58;">1</span><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">or</span> <br>				<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">oddp</span> x<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f9ae58;">1</span> <span style="color:#5fb4b4;">(</span>countO <span style="color:#5fb4b4;">(</span>collatz x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">(</span>countO <span style="color:#5fb4b4;">(</span>collatz x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span><br><span style="color:#5fb4b4;">)</span><br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">countEO2</span>   <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span>counte x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span>counto x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>	<span style="color:#5fb4b4;">)</span><br><br><br><br>"""----------------------------------------------------------------------------------------"""<br>"""-------------------					Exercise 4.69					-------------------"""<br>"""----------------------------------------------------------------------------------------"""<br><br>A growing difference sequence is a recursive sequence where each non-initial term <br>in the sequence is greater than the one before it by a difference that steadily grows <br>with the terms. For instance 1, 4, 8, 13, 19, 26,. . . is such a sequence where the second <br>term is obtained by adding 3 to the first, third term is obtained by adding 4 to the <br>second, fourth term is obtained by adding 5 to the third, and so on. In tabular form:<br><br>Our sequences will always start with 1. How the difference starts and grows<br>may change from sequence to sequence. For instance the difference in the follow-<br>ing sequence starts with 2 and grows as the square of the previous difference.<br><br>Define a procedure GDS that generates a growing difference sequence where the<br>length of the sequence, the initial value of the difference and how difference grows<br>will be given as parameters. An example output for the first 7 terms in the first ex-<br>ample above would be <span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">8</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">13</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">19</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">6</span> <span style="color:#f9ae58;">26</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">7</span> <span style="color:#f9ae58;">34</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>.<br><br><br>GDS - >  length = 7 ,  initial value of difference = + 3,  how grows = algorithm  here +1 ?<br><br><br>Our sequences will always start with 1<br><br><br><span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">gds</span> <span style="color:#5fb4b4;">(</span>len iv_of_diff growth counter storage<span style="color:#5fb4b4;">)</span><br><br><br>	<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">&lt;</span> counter len<span style="color:#5fb4b4;">)</span> 				<span style="color:#5fb4b4;">(</span>gds len iv_of_diff growth <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>	<span style="color:#5fb4b4;">)</span></div><script>window.print()</script></body></html>