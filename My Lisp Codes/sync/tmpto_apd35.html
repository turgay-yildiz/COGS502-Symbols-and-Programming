<html><head><meta charset="UTF-8"></head><body><div style="white-space:pre;font-family:Monospace;color:#d8dee9;background-color:#303841;-moz-tab-size:4;tab-size:4;">			"""#--------------------------------------------------------------------------------------#"""<br>			"""#----------------------         METU Cognitive Sciences         -----------------------#"""<br>			"""#----------------------          Symbols &amp; Programming          -----------------------#"""<br>			"""#----------------------              Turgay Yıldız              -----------------------#"""<br>			"""#----------------------        yildiz.turgay@metu.edu.tr        -----------------------#"""<br>			"""#--------------------------------------------------------------------------------------#"""<br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                   Exercise 8.1                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""<br><br>			Define a procedure APPEND2 that appends two lists.<br><br>			<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span>      ->		<span style="color:#5fb4b4;">(</span>a b c <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">append2</span> <span style="color:#5fb4b4;">(</span>lst1 lst2<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dolist</span> <span style="color:#5fb4b4;">(</span>i <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> lst1<span style="color:#5fb4b4;">)</span> lst2<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> lst2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> i lst2<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			* <span style="color:#5fb4b4;">(</span>append2 '<span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span>A B C <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span><br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                   Exercise 8.2                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""<br><br>			Define an iterative procedure CHOP-LAST, which removes the final element of the<br>			given list – its like CDR from the back. You are NOT allowed to make<br>			<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">REVERSE</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">CDR</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">REVERSE</span> LST<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>. Nothing to be done for an empty list, just<br>			return it as it is<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">but </span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">single </span><span style="color:#a6acb9;">element </span><span style="color:#a6acb9;">list </span><span style="color:#a6acb9;">gets </span><span style="color:#a6acb9;">“nilled”.</span><br><br>			<span style="color:#5fb4b4;">(</span>a b c <span style="color:#c695c6;">d</span><span style="color:#5fb4b4;">)</span>   ->    <span style="color:#5fb4b4;">(</span>a b c<span style="color:#5fb4b4;">)</span> <br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">chop_last</span> 	<span style="color:#5fb4b4;">(</span>x   storage<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span>								<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> 						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 									<span style="color:#5fb4b4;">(</span>chop_last <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""-------------------                   Second Way                   -------------------"""<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">chop_last2</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span><br><br>					x<span style="color:#5fb4b4;">)</span><br><br>				lst <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">make-list</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                   Exercise 8.3                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""<br><br><br>			Define an iterative procedure UNIQ that takes a list and removes all the repeated<br>			elements in the list keeping only the first occurrence. This is the expected behavior:<br><br>			* <span style="color:#5fb4b4;">(</span>uniq '<span style="color:#5fb4b4;">(</span>a b r a c a <span style="color:#c695c6;">d</span> a b r a<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span>A B R C <span style="color:#c695c6;">D</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">unique-list</span>  <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span>	<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">initially  </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">storage </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">nil) </span><span style="color:#a6acb9;">and </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">reader </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">car </span><span style="color:#a6acb9;">x) </span><span style="color:#a6acb9;">) </span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span> 						<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">member</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>		<span style="color:#5fb4b4;">(</span>unique<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>unique<span style="color:#f97b58;">-</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                   Exercise 8.4                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""<br><br>			Define a procedure that reverses the top-level elements of a list.<br><br>			<span style="color:#5fb4b4;">(</span> a b c <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span> e <span style="color:#6699cc;font-style:italic;">f</span><span style="color:#5fb4b4;">)</span> g k l<span style="color:#5fb4b4;">)</span>   ->    <span style="color:#5fb4b4;">(</span>l k g <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span> e <span style="color:#6699cc;font-style:italic;">f</span><span style="color:#5fb4b4;">)</span> c b a<span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">my_reverse</span> <span style="color:#5fb4b4;">(</span>lst storage<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span> 							storage<span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span> 									<span style="color:#5fb4b4;">(</span>my_reverse <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                   Exercise 8.5                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""<br><br>			The mean of n numbers is computed by dividing their sum by n. A running mean<br>			is a mean that gets updated as we encounter more numbers. Observe the following<br>			input-output sequences:<br><br>			* <span style="color:#5fb4b4;">(</span>run<span style="color:#f97b58;">-</span>mean '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">7</span> <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<br>						<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">6</span><span style="color:#5fb4b4;">)</span><br><br>			The first element 3 is the mean of the list <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span>, the second element 4 is the mean<br>			of <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">5</span><span style="color:#5fb4b4;">)</span>, and so on. Implement RUN-MEAN by using DOTIMES and NTH.<br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">run_mean</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>result 							<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>						  <span style="color:#5fb4b4;">(</span>cum_total  						<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>						  <span style="color:#5fb4b4;">(</span>mean 							<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dotimes</span> 	<span style="color:#5fb4b4;">(</span>i <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> result<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> cum_total   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i lst<span style="color:#5fb4b4;">)</span> cum_total<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> mean  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">float</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">/</span> cum_total <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> i <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> mean result<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                   Exercise 8.6                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""<br><br><br>			Define a procedure SEARCH-POS that takes a list as search item, another list as a<br>			search list and returns the list of positions that the search item is found in the search<br>			list. As usual, positioning starts with 0. Use DOTIMES. A sample interaction:<br><br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">search</span><span style="color:#f97b58;">-</span>pos '<span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span>a b c <span style="color:#c695c6;">d</span> a b a b<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>									<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">6</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br><br>			* <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">search</span><span style="color:#f97b58;">-</span>pos '<span style="color:#5fb4b4;">(</span>a a<span style="color:#5fb4b4;">)</span> '<span style="color:#5fb4b4;">(</span>a a a a b a b<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>									'<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">search_pos</span> <span style="color:#5fb4b4;">(</span>lst1 lst2 counter storage<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>result 					<span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br>						  <span style="color:#5fb4b4;">(</span>flag 					<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>						  <span style="color:#5fb4b4;">(</span>len_1 					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst1<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						  <span style="color:#5fb4b4;">(</span>len_2 					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst2<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">></span> len_1 len_2<span style="color:#5fb4b4;">)</span> 						<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>							  <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">t</span><br><br>								<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> <br><br>									<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dotimes</span> 	<span style="color:#5fb4b4;">(</span>i len_1 result<span style="color:#5fb4b4;">)</span><br><br>										<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">equal</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i lst1<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> i lst2<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> flag <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>												<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result <span style="color:#ec5f66;font-style:italic;">t</span><span style="color:#5fb4b4;">)</span><br>												<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> flag <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <br>										<span style="color:#5fb4b4;">)</span><br>									<span style="color:#5fb4b4;">)</span><br>									<span style="color:#5fb4b4;">(</span>search_pos lst1 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst2<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> counter storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>									<span style="color:#5fb4b4;">(</span>search_pos lst1 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst2<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <br>								<span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                   Exercise 8.7                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""<br><br>			Define a procedure that reverses the elements in a list including its sublists as well.<br><br><br>			<span style="color:#5fb4b4;">(</span> a b c <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span> e <span style="color:#6699cc;font-style:italic;">f</span><span style="color:#5fb4b4;">)</span> g k l<span style="color:#5fb4b4;">)</span>   ->    <span style="color:#5fb4b4;">(</span>l k g <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">f</span> e g<span style="color:#5fb4b4;">)</span> c b a<span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">my_reverse2</span> <span style="color:#5fb4b4;">(</span>lst storage<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">null</span> lst<span style="color:#5fb4b4;">)</span> 							storage<span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">listp</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>  					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span> <span style="color:#5fb4b4;">(</span>my_reverse2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span>my_reverse2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						  <span style="color:#5fb4b4;">(</span><span style="color:#ec5f66;font-style:italic;">t</span> 									<span style="color:#5fb4b4;">(</span>my_reverse2 <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                   Exercise 8.8                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""<br><br>			Write a procedure LAST-NTH that returns the nth element from the end of a given<br>			list. Do NOT use NTH or ELT<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">use </span><span style="color:#a6acb9;">DOLIST.</span><br><br>			2   '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">6</span> <span style="color:#f9ae58;">5</span> <span style="color:#f9ae58;">4</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> 		-> 			2   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">last</span> <span style="color:#f9ae58;">2</span> <span style="color:#f97b58;">=</span> <span style="color:#6699cc;font-style:italic;">first</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span>    <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> <span style="color:#f97b58;">-</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> - n<br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">last-nth</span> <span style="color:#5fb4b4;">(</span>n lst<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>result 			<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>						 <span style="color:#5fb4b4;">(</span>len 				<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> n<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						 <span style="color:#5fb4b4;">(</span>counter 			<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">)</span><br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dolist</span> <span style="color:#5fb4b4;">(</span>i lst result<span style="color:#5fb4b4;">)</span><br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> counter len<span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">nth</span> counter lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> counter <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> counter <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> counter <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                   Exercise 8.9                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""<br><br>			See the PAIRLISTS in lecture notes. Define a procedure that “pairs” an arbitrary<br>			number of lists. Here is a sample interaction:<br><br>			* <span style="color:#5fb4b4;">(</span>pairlists '<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#f97b58;">=</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f97b58;">-</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>							<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span>A <span style="color:#f97b58;">=</span> <span style="color:#f9ae58;">1</span> <span style="color:#f97b58;">+</span> <span style="color:#f9ae58;">3</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span>B <span style="color:#f97b58;">=</span> <span style="color:#f9ae58;">2</span> <span style="color:#f97b58;">-</span> <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br>			pairlist '<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>a b<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#f97b58;">=</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> <span style="color:#f97b58;">-</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">9</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  nil nil<span style="color:#f7f7f7;background-color:#ec5f66;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span>  <span style="color:#5fb4b4;">pairlist</span>  <span style="color:#5fb4b4;">(</span>x   list1  list2<span style="color:#5fb4b4;">)</span><br><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">endp</span> x<span style="color:#5fb4b4;">)</span> 					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> list1<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> list2<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>							<span style="color:#5fb4b4;">(</span>pairlist  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> x<span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">caar</span> x<span style="color:#5fb4b4;">)</span> list1<span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cadar</span> x<span style="color:#5fb4b4;">)</span> list2<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#a6acb9;">;</span><span style="color:#a6acb9;"> </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">pairlist </span><span style="color:#a6acb9;">'( </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">a </span><span style="color:#a6acb9;">b) </span><span style="color:#a6acb9;">(= </span><span style="color:#a6acb9;">=) </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">2) </span><span style="color:#a6acb9;">(+ </span><span style="color:#a6acb9;">-) </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">3 </span><span style="color:#a6acb9;">9) </span><span style="color:#a6acb9;">)  </span><span style="color:#a6acb9;">nil </span><span style="color:#a6acb9;">nil) </span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">will </span><span style="color:#a6acb9;">return </span><span style="color:#a6acb9;">	</span><span style="color:#a6acb9;">((A </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">1 </span><span style="color:#a6acb9;">+ </span><span style="color:#a6acb9;">3) </span><span style="color:#a6acb9;">(</span><span style="color:#a6acb9;">B </span><span style="color:#a6acb9;">= </span><span style="color:#a6acb9;">2 </span><span style="color:#a6acb9;">- </span><span style="color:#a6acb9;">9))</span><br><br><br>			"""#----------------------		Second Way		-----------------------#"""<br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">pairlist2</span>  <span style="color:#5fb4b4;">(</span>x<span style="color:#5fb4b4;">)</span><br><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">append</span>     <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#6699cc;font-style:italic;">car</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span>   <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span>  <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#6699cc;font-style:italic;">cadr</span> x<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>				<br>			<span style="color:#5fb4b4;">)</span><br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                   Exercise 8.10                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""<br><br>			Define a procedure ENUMERATE that enumerates a list of items. Numeration starts<br>			with 0. Define two versions, one with, and one without an accumulator.<br><br>			CL-USER > <span style="color:#5fb4b4;">(</span> enumerate '<span style="color:#5fb4b4;">(</span> A B C <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>				<br>					<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span> A <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> B <span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">2</span> C <span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">range</span> <span style="color:#5fb4b4;">(</span>x   storage<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">cond</span>	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">eq</span> x <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> 				<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">eq</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>				<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#f9ae58;">0</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span> <span style="color:#ec5f66;font-style:italic;">t</span>						<span style="color:#5fb4b4;">(</span>range  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> x <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span> storage<span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span>  <span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span>range <span style="color:#f9ae58;">5</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">2</span> <span style="color:#f9ae58;">3</span> <span style="color:#f9ae58;">4</span><span style="color:#5fb4b4;">)</span><br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">enum_</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">mapcar</span> <span style="color:#5fb4b4;">#</span><span style="color:#c695c6;">'</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">lambda</span> <span style="color:#5fb4b4;">(</span>x y<span style="color:#5fb4b4;">)</span> <br><br>					<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">list</span> x y<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>				lst <span style="color:#5fb4b4;">(</span>range <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">length</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                   Exercise 8.11                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""<br><br><br>			Write a program that takes a sequence, a start index, an end index and returns the<br>			sub-sequence from start to <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> including<span style="color:#5fb4b4;">)</span> end. Indices start from 0.<br><br><br>			'<span style="color:#5fb4b4;">(</span><span style="color:#5fb4b4;">(</span> a b c     <span style="color:#c695c6;">d</span> e <span style="color:#6699cc;font-style:italic;">f</span>    g h <span style="color:#5fb4b4;">)</span>	<span style="color:#f9ae58;">3</span>  <span style="color:#f9ae58;">5</span> <span style="color:#5fb4b4;">)</span>			->	    <span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">d</span> e <span style="color:#6699cc;font-style:italic;">f</span><span style="color:#5fb4b4;">)</span>	<br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">sub-seq</span> <span style="color:#5fb4b4;">(</span>lst start end <span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>result  						<span style="color:#ec5f66;font-style:italic;">nil</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dolist</span>  <span style="color:#5fb4b4;">(</span>i lst <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">reverse</span> result<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>  <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> start <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">>=</span> end <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>							 <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cons</span> i result<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> end <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> end <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>							 <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> start <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> start <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> end <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> end <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">)</span><br>					<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                   Exercise 8.12                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""<br><br>			Given a sequence of 0s and 1s, return the number of 0s that are preceded by a 0.<br>			Here is a sample interaction:<br><br>			CL-USER > <span style="color:#5fb4b4;">(</span> zeros '<span style="color:#5fb4b4;">(</span><span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">0</span> <span style="color:#f9ae58;">1</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>					2<br><br><br>			<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;font-style:italic;">defun</span> <span style="color:#5fb4b4;">zeros</span> <span style="color:#5fb4b4;">(</span>lst<span style="color:#5fb4b4;">)</span><br><br>				<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span> 	<span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">not</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">car</span> lst<span style="color:#5fb4b4;">)</span> <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">(</span>zeros <span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">cdr</span> lst<span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>						<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">let</span> 	<span style="color:#5fb4b4;">(</span> <span style="color:#5fb4b4;">(</span>result  				<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>								  <span style="color:#5fb4b4;">(</span>flag 				<span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">)</span><br><br>							<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">dolist</span>  <span style="color:#5fb4b4;">(</span>i lst <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">-</span> result <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br><br>								<span style="color:#5fb4b4;">(</span><span style="color:#c695c6;">if</span>   <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">and</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> i <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span> <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">=</span> flag <span style="color:#f9ae58;">0</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>										<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> result <span style="color:#5fb4b4;">(</span><span style="color:#f97b58;">+</span> result <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><span style="color:#5fb4b4;">)</span><br>										<span style="color:#5fb4b4;">(</span><span style="color:#6699cc;font-style:italic;">setf</span> flag <span style="color:#f9ae58;">1</span><span style="color:#5fb4b4;">)</span><br>								<span style="color:#5fb4b4;">)</span><br>							<span style="color:#5fb4b4;">)</span><br>						<span style="color:#5fb4b4;">)</span><br>				<span style="color:#5fb4b4;">)</span><br>			<span style="color:#5fb4b4;">)</span><br><br>			"""----------------------------------------------------------------------------------------"""<br>			"""-------------------                 			  END                   -------------------"""<br>			"""----------------------------------------------------------------------------------------"""</div><script>window.print()</script></body></html>